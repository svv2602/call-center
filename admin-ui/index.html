<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Call Center AI — Admin</title>
    <script>
        // Prevent FOUC: apply dark class before first paint
        (function() {
            var t = localStorage.getItem('admin_theme');
            if (t === 'dark' || (!t && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>
</head>
<body class="bg-neutral-50 dark:bg-neutral-950 text-neutral-900 dark:text-neutral-50 font-sans antialiased">
    <!-- Toast container -->
    <div class="fixed top-4 right-4 z-[200] flex flex-col gap-2" id="toastContainer"></div>

    <!-- Login -->
    <div class="flex justify-center items-center min-h-screen" id="loginContainer">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 p-8 rounded-xl shadow-lg w-80">
            <h1 class="text-lg font-semibold text-center mb-6 text-neutral-900 dark:text-neutral-50">Call Center AI</h1>
            <div class="text-red-500 text-sm mb-2 hidden" id="loginError" data-i18n="login.error">Неверные учётные данные</div>
            <input type="text" id="loginUsername" data-i18n-placeholder="login.username" placeholder="Имя пользователя"
                class="w-full px-3 py-2 mb-3 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            <input type="password" id="loginPassword" data-i18n-placeholder="login.password" placeholder="Пароль"
                class="w-full px-3 py-2 mb-4 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            <button onclick="window._app.login()"
                class="w-full py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500" data-i18n="login.submit">Войти</button>
        </div>
    </div>

    <!-- App -->
    <div class="hidden" id="app">
        <!-- Hamburger (mobile) -->
        <button class="hidden max-md:block fixed top-3 left-3 z-50 bg-zinc-900 text-white border-none rounded-md px-2.5 py-1.5 cursor-pointer text-xl"
            id="hamburgerBtn" onclick="window._app.toggleSidebar()">&#9776;</button>

        <!-- Sidebar (icon-only, flyout on hover) -->
        <nav class="sidebar fixed left-0 top-0 bottom-0 w-14 max-md:w-64 bg-zinc-950 text-neutral-300 flex flex-col z-40" id="sidebar">
            <!-- Logo + expand toggle -->
            <div class="flex items-center justify-center h-14 border-b border-zinc-800 shrink-0 relative">
                <svg class="w-7 h-7 text-blue-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z"/>
                </svg>
                <span class="sidebar-title hidden text-sm font-semibold text-white tracking-wide ml-2">Call Center AI</span>
                <button onclick="window._app.toggleSidebarExpand()" class="sidebar-expand-btn" id="sidebarExpandBtn" title="Развернуть/Свернуть">
                    <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5"/></svg>
                </button>
            </div>
            <!-- Nav items -->
            <div class="flex-1 py-1 flex flex-col">
                <!-- Dashboard -->
                <a href="#" class="nav-item active" data-page="dashboard" onclick="window._app.showPage('dashboard')">
                    <svg class="nav-icon" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955a1.126 1.126 0 011.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"/></svg>
                    <span class="nav-tooltip" data-i18n="nav.dashboard">Дашборд</span>
                </a>
                <!-- Calls -->
                <a href="#" class="nav-item" data-page="calls" onclick="window._app.showPage('calls')">
                    <svg class="nav-icon" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z"/></svg>
                    <span class="nav-tooltip" data-i18n="nav.calls">Журнал звонков</span>
                </a>
                <!-- Training group (flyout) -->
                <div class="nav-group" data-group="training">
                    <div class="nav-item nav-group-trigger" onclick="window._app.toggleSidebarGroup('training')">
                        <svg class="nav-icon" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.26 10.147a60.438 60.438 0 00-.491 6.347A48.62 48.62 0 0112 20.904a48.62 48.62 0 018.232-4.41 60.46 60.46 0 00-.491-6.347m-15.482 0a50.636 50.636 0 00-2.658-.813A59.906 59.906 0 0112 3.493a59.903 59.903 0 0110.399 5.84 51.39 51.39 0 00-2.658.814m-15.482 0A50.717 50.717 0 0112 13.489a50.702 50.702 0 017.74-3.342M6.75 15a.75.75 0 100-1.5.75.75 0 000 1.5zm0 0v-3.675A55.378 55.378 0 0112 8.443m-7.007 11.55A5.981 5.981 0 006.75 15.75v-1.5"/></svg>
                        <span class="nav-group-label" data-i18n="nav.training">Обучение агента</span>
                        <svg class="nav-chevron" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg>
                    </div>
                    <div class="nav-flyout">
                        <div class="nav-flyout-title" data-i18n="nav.training">Обучение агента</div>
                        <a href="#" class="nav-flyout-link" data-page="prompts" onclick="window._app.showPage('prompts')">
                            <svg class="w-4 h-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"/></svg>
                            <span data-i18n="nav.prompts">Промпты</span>
                        </a>
                        <a href="#" class="nav-flyout-link" data-page="knowledge" onclick="window._app.showPage('knowledge')">
                            <svg class="w-4 h-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"/></svg>
                            <span data-i18n="nav.knowledge">База знаний</span>
                        </a>
                        <a href="#" class="nav-flyout-link" data-page="scenarios" onclick="window._app.showPage('scenarios')">
                            <svg class="w-4 h-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 01-.825-.242m9.345-8.334a2.126 2.126 0 00-.476-.095 48.64 48.64 0 00-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0011.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"/></svg>
                            <span data-i18n="nav.scenarios">Сценарии</span>
                        </a>
                        <a href="#" class="nav-flyout-link" data-page="tools" onclick="window._app.showPage('tools')">
                            <svg class="w-4 h-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M11.42 15.17l-5.1-2.55a1.5 1.5 0 01-.82-1.33V7.82a1.5 1.5 0 01.82-1.33l5.1-2.55a1.5 1.5 0 011.34 0l5.1 2.55a1.5 1.5 0 01.82 1.33v3.47a1.5 1.5 0 01-.82 1.33l-5.1 2.55a1.5 1.5 0 01-1.34 0zM3.5 7l8.58 4.29M12.08 21.5V11.29M20.5 7l-8.58 4.29"/></svg>
                            <span data-i18n="nav.tools">Инструменты</span>
                        </a>
                        <a href="#" class="nav-flyout-link" data-page="sandbox" onclick="window._app.showPage('sandbox')">
                            <svg class="w-4 h-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.75 3.104v5.714a2.25 2.25 0 01-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 014.5 0m0 0v5.714a2.25 2.25 0 00.659 1.591L19 14.5M14.25 3.104c.251.023.501.05.75.082M19 14.5l-2.47 5.527a.5.5 0 01-.457.298H7.927a.5.5 0 01-.457-.298L5 14.5m14 0H5"/></svg>
                            <span data-i18n="nav.sandbox">Песочница</span>
                        </a>
                    </div>
                </div>
                <!-- Operators -->
                <a href="#" class="nav-item" data-page="operators" onclick="window._app.showPage('operators')">
                    <svg class="nav-icon" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 18.719m12 0a5.971 5.971 0 00-.941-3.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-5.058 2.772m0 0a3 3 0 00-4.681 2.72 8.986 8.986 0 003.74.477m.94-3.197a5.971 5.971 0 00-.94 3.197M15 6.75a3 3 0 11-6 0 3 3 0 016 0zm6 3a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zm-13.5 0a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"/></svg>
                    <span class="nav-tooltip" data-i18n="nav.operators">Операторы</span>
                </a>
                <!-- Settings group (flyout) -->
                <div class="nav-group" data-group="settings">
                    <div class="nav-item nav-group-trigger" onclick="window._app.toggleSidebarGroup('settings')">
                        <svg class="nav-icon" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 010 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 010-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28z"/><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
                        <span class="nav-group-label" data-i18n="nav.system">Система</span>
                        <svg class="nav-chevron" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg>
                    </div>
                    <div class="nav-flyout">
                        <div class="nav-flyout-title" data-i18n="nav.system">Система</div>
                        <a href="#" class="nav-flyout-link" data-page="monitoring" onclick="window._app.showPage('monitoring')">
                            <svg class="w-4 h-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"/></svg>
                            <span data-i18n="nav.monitoring">Мониторинг</span>
                        </a>
                        <a href="#" class="nav-flyout-link" data-page="configuration" onclick="window._app.showPage('configuration')">
                            <svg class="w-4 h-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"/></svg>
                            <span data-i18n="nav.configuration">Конфигурация</span>
                        </a>
                        <a href="#" class="nav-flyout-link" data-page="tenants" onclick="window._app.showPage('tenants')">
                            <svg class="w-4 h-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6H15m-1.5 3H15m-1.5 3H15M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21"/></svg>
                            <span data-i18n="nav.tenants">Сети</span>
                        </a>
                        <a href="#" class="nav-flyout-link" data-page="notifications" onclick="window._app.showPage('notifications')">
                            <svg class="w-4 h-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0"/></svg>
                            <span data-i18n="nav.notifications">Уведомления</span>
                        </a>
                        <a href="#" class="nav-flyout-link" data-page="onec-data" onclick="window._app.showPage('onec-data')">
                            <svg class="w-4 h-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M20.25 6.375c0 2.278-3.694 4.125-8.25 4.125S3.75 8.653 3.75 6.375m16.5 0c0-2.278-3.694-4.125-8.25-4.125S3.75 4.097 3.75 6.375m16.5 0v11.25c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125V6.375m16.5 0v3.75c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125v-3.75m16.5 3.75v3.75c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125v-3.75"/></svg>
                            <span data-i18n="nav.onecData">Данные 1С</span>
                        </a>
                    </div>
                </div>
                <!-- Users (admin-only) -->
                <a href="#" class="nav-item admin-only" data-page="users" onclick="window._app.showPage('users')">
                    <svg class="nav-icon" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"/></svg>
                    <span class="nav-tooltip" data-i18n="nav.users">Пользователи</span>
                </a>
                <!-- Audit (admin-only) -->
                <a href="#" class="nav-item admin-only" data-page="audit" onclick="window._app.showPage('audit')">
                    <svg class="nav-icon" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z"/></svg>
                    <span class="nav-tooltip" data-i18n="nav.audit">Аудит</span>
                </a>
                <!-- Vehicles -->
                <a href="#" class="nav-item" data-page="vehicles" onclick="window._app.showPage('vehicles')">
                    <svg class="nav-icon" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 18.75a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 01-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0H21a.75.75 0 00.75-.75v-3.375a3 3 0 00-.874-2.121l-2.126-2.126A3 3 0 0016.629 9H14.25m0 9V3.75A.75.75 0 0013.5 3h-6a.75.75 0 00-.75.75V18"/></svg>
                    <span class="nav-tooltip" data-i18n="nav.vehicles">База авто</span>
                </a>
            </div>
            <!-- Footer -->
            <div class="border-t border-zinc-800 py-2 flex flex-col items-center gap-1 shrink-0">
                <button onclick="window._app.toggleTheme()" id="themeToggle"
                    class="nav-item" title="Theme" style="height:36px">
                    <span id="themeIcon" class="text-base"></span>
                    <span id="themeLabel" class="hidden max-md:inline ml-2 text-xs">Тёмная</span>
                </button>
                <button onclick="window._app.toggleLang()"
                    class="nav-item" title="Language" style="height:36px">
                    <svg class="nav-icon" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9.004 9.004 0 008.716-6.747M12 21a9.004 9.004 0 01-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 017.843 4.582M12 3a8.997 8.997 0 00-7.843 4.582m15.686 0A11.953 11.953 0 0112 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0112 16.5a17.92 17.92 0 01-8.716-2.247m0 0A8.966 8.966 0 013 12c0-1.777.514-3.432 1.4-4.83"/></svg>
                    <span class="nav-tooltip" id="langLabel">EN</span>
                </button>
                <div class="flex items-center justify-center h-8 w-full" id="wsStatus" title="WebSocket">
                    <span class="w-2 h-2 rounded-full bg-red-500" id="wsDot"></span>
                    <span id="wsLabel" class="hidden max-md:inline ml-2 text-xs text-neutral-500">Оффлайн</span>
                </div>
            </div>
            <div class="border-t border-zinc-800 py-2 flex justify-center shrink-0">
                <a href="#" class="nav-item" style="height:36px" onclick="window._app.logout()" data-i18n="nav.logout" title="Выход">
                    <svg class="nav-icon text-red-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"/></svg>
                    <span class="nav-tooltip" style="color:rgb(248 113 113)" data-i18n="nav.logout">Выход</span>
                </a>
            </div>
        </nav>

        <!-- Main content -->
        <div class="main-content ml-14 max-md:ml-0 p-6 max-md:p-4 min-h-screen">
            <!-- Dashboard -->
            <div id="page-dashboard">
                <div class="text-xs text-neutral-500 dark:text-neutral-400 mb-3"><a href="#/dashboard" class="text-blue-600 dark:text-blue-400 hover:underline">Home</a> / <span data-i18n="dashboard.breadcrumb">Дашборд</span></div>
                <div class="flex items-center gap-2 mb-4">
                    <h1 class="text-lg font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="dashboard.title">Дашборд</h1>
                    <button onclick="window._app.openHelp('dashboard')" class="w-6 h-6 rounded-full border border-neutral-300 dark:border-neutral-600 text-neutral-400 hover:text-blue-600 hover:border-blue-400 dark:hover:text-blue-400 dark:hover:border-blue-400 text-xs font-bold transition-colors flex items-center justify-center" title="Help">?</button>
                </div>
                <div class="flex items-center gap-3 mb-4" id="dashboardTenantFilter"></div>
                <div class="grid grid-cols-[repeat(auto-fill,minmax(180px,1fr))] gap-4 mb-6 max-md:grid-cols-2 max-[480px]:grid-cols-1" id="dashboardStats">
                    <div class="flex justify-center py-8"><div class="spinner"></div></div>
                </div>
                <div class="flex gap-2 mb-4 flex-wrap">
                    <button class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-emerald-600 text-white hover:bg-emerald-700" onclick="window._pages.dashboard.exportStatsCSV()" data-i18n="dashboard.exportCSV">Экспорт CSV</button>
                    <button class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-violet-600 text-white hover:bg-violet-700" onclick="window._pages.dashboard.downloadPdfReport()" data-i18n="dashboard.downloadPDF">Скачать PDF</button>
                </div>
                <!-- Grafana iframe — hidden until Grafana is configured (Phase 4) -->
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4" id="grafanaBlock" style="display:none">
                    <h3 class="text-sm font-semibold text-neutral-900 dark:text-neutral-50 mb-3" data-i18n="dashboard.grafana">Grafana в реальном времени</h3>
                    <iframe class="w-full h-[600px] max-md:h-[350px] border-none rounded-lg" id="grafanaFrame" src=""></iframe>
                </div>
            </div>

            <!-- Calls -->
            <div id="page-calls" style="display:none">
                <div class="text-xs text-neutral-500 dark:text-neutral-400 mb-3"><a href="#/dashboard" class="text-blue-600 dark:text-blue-400 hover:underline">Home</a> / <span data-i18n="calls.breadcrumb">Журнал звонков</span></div>
                <div class="flex items-center gap-2 mb-4">
                    <h1 class="text-lg font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="calls.title">Журнал звонков</h1>
                    <button onclick="window._app.openHelp('calls')" class="w-6 h-6 rounded-full border border-neutral-300 dark:border-neutral-600 text-neutral-400 hover:text-blue-600 hover:border-blue-400 dark:hover:text-blue-400 dark:hover:border-blue-400 text-xs font-bold transition-colors flex items-center justify-center" title="Help">?</button>
                </div>
                <div class="flex flex-wrap items-center gap-2 mb-4">
                    <input type="date" id="filterDateFrom" onchange="window._pages.calls.loadCalls()" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                    <input type="date" id="filterDateTo" onchange="window._pages.calls.loadCalls()" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                    <select id="filterScenario" onchange="window._pages.calls.loadCalls()" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                        <option value="" data-i18n="calls.allScenarios">Все сценарии</option>
                        <option value="tire_search" data-i18n="calls.tireSearch">Поиск шин</option>
                        <option value="availability" data-i18n="calls.availability">Наличие</option>
                        <option value="order" data-i18n="calls.order">Заказ</option>
                        <option value="fitting" data-i18n="calls.fitting">Шиномонтаж</option>
                        <option value="consultation" data-i18n="calls.consultation">Консультация</option>
                    </select>
                    <select id="filterTransferred" onchange="window._pages.calls.loadCalls()" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                        <option value="" data-i18n="calls.all">Все</option>
                        <option value="true" data-i18n="calls.transferred">Переведено</option>
                        <option value="false" data-i18n="calls.resolvedByBot">Решено ботом</option>
                    </select>
                    <input type="text" id="filterSearch" data-i18n-placeholder="calls.searchPlaceholder" placeholder="Поиск в транскрипции..."
                        onkeydown="if(event.key==='Enter')window._pages.calls.loadCalls()"
                        class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                    <input type="number" id="filterQualityBelow" data-i18n-placeholder="calls.qualityBelow" placeholder="Качество ниже" step="0.1" min="0" max="1"
                        onchange="window._pages.calls.loadCalls()"
                        class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                    <select id="filterTenant" onchange="window._pages.calls.loadCalls()" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                        <option value="" data-i18n="dashboard.allNetworks">Все сети</option>
                    </select>
                    <button onclick="window._pages.calls.loadCalls()"
                        class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700 max-md:w-full" data-i18n="common.filter">Фильтровать</button>
                    <button onclick="window._pages.calls.exportCallsCSV()"
                        class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-emerald-600 text-white hover:bg-emerald-700 max-md:w-full" data-i18n="calls.exportCSV">Экспорт CSV</button>
                </div>
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4 relative">
                    <div id="callsLoading" class="flex justify-center py-8" style="display:none"><div class="spinner"></div></div>
                    <div class="overflow-x-auto min-h-[480px]">
                        <table class="w-full text-sm" id="callsTable">
                            <thead>
                                <tr>
                                    <th class="px-3 py-2.5 text-left text-xs font-semibold text-neutral-500 dark:text-neutral-400 uppercase tracking-wider border-b border-neutral-200 dark:border-neutral-700" data-i18n="calls.date" data-sortable>Дата</th>
                                    <th class="px-3 py-2.5 text-left text-xs font-semibold text-neutral-500 dark:text-neutral-400 uppercase tracking-wider border-b border-neutral-200 dark:border-neutral-700" data-i18n="calls.caller" data-sortable>Звонящий</th>
                                    <th class="px-3 py-2.5 text-left text-xs font-semibold text-neutral-500 dark:text-neutral-400 uppercase tracking-wider border-b border-neutral-200 dark:border-neutral-700" data-i18n="calls.scenario" data-sortable>Сценарий</th>
                                    <th class="px-3 py-2.5 text-left text-xs font-semibold text-neutral-500 dark:text-neutral-400 uppercase tracking-wider border-b border-neutral-200 dark:border-neutral-700" data-i18n="calls.duration" data-sortable>Длительность</th>
                                    <th class="px-3 py-2.5 text-left text-xs font-semibold text-neutral-500 dark:text-neutral-400 uppercase tracking-wider border-b border-neutral-200 dark:border-neutral-700" data-i18n="calls.quality" data-sortable>Качество</th>
                                    <th class="px-3 py-2.5 text-left text-xs font-semibold text-neutral-500 dark:text-neutral-400 uppercase tracking-wider border-b border-neutral-200 dark:border-neutral-700" data-i18n="calls.cost" data-sortable>Стоимость</th>
                                    <th class="px-3 py-2.5 text-left text-xs font-semibold text-neutral-500 dark:text-neutral-400 uppercase tracking-wider border-b border-neutral-200 dark:border-neutral-700" data-i18n="calls.status" data-sortable>Статус</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <div class="pagination flex justify-center gap-1 mt-4" id="callsPagination"></div>
                </div>
            </div>

            <!-- Prompts -->
            <div id="page-prompts" style="display:none">
                <div class="text-xs text-neutral-500 dark:text-neutral-400 mb-3"><a href="#/dashboard" class="text-blue-600 dark:text-blue-400 hover:underline">Home</a> / <span data-i18n="nav.training">Обучение</span> / <span data-i18n="nav.prompts">Промпты</span></div>
                <div class="flex items-center gap-2 mb-4">
                    <h1 class="text-lg font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="nav.prompts">Промпты</h1>
                    <button onclick="window._app.openHelp('prompts')" class="w-6 h-6 rounded-full border border-neutral-300 dark:border-neutral-600 text-neutral-400 hover:text-blue-600 hover:border-blue-400 dark:hover:text-blue-400 dark:hover:border-blue-400 text-xs font-bold transition-colors flex items-center justify-center" title="Help">?</button>
                </div>
                <div id="promptsContent" class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4"></div>
            </div>

            <!-- Knowledge (Articles + Sources) -->
            <div id="page-knowledge" style="display:none">
                <div class="text-xs text-neutral-500 dark:text-neutral-400 mb-3"><a href="#/dashboard" class="text-blue-600 dark:text-blue-400 hover:underline">Home</a> / <span data-i18n="nav.training">Обучение</span> / <span data-i18n="nav.knowledge">База знаний</span></div>
                <div class="flex items-center gap-2 mb-4">
                    <h1 class="text-lg font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="nav.knowledge">База знаний</h1>
                    <button onclick="window._app.openHelp('knowledge')" class="w-6 h-6 rounded-full border border-neutral-300 dark:border-neutral-600 text-neutral-400 hover:text-blue-600 hover:border-blue-400 dark:hover:text-blue-400 dark:hover:border-blue-400 text-xs font-bold transition-colors flex items-center justify-center" title="Help">?</button>
                </div>
                <div class="tab-bar flex border-b border-neutral-200 dark:border-neutral-700 mb-4 flex-wrap">
                    <button class="active px-4 py-2 text-sm text-neutral-500 dark:text-neutral-400 border-b-2 border-transparent -mb-px cursor-pointer transition-colors hover:text-neutral-700 dark:hover:text-neutral-200" data-tab="articles" onclick="window._pages.knowledge.showTab('articles')" data-i18n="training.tabKnowledge">Статьи</button>
                    <button class="px-4 py-2 text-sm text-neutral-500 dark:text-neutral-400 border-b-2 border-transparent -mb-px cursor-pointer transition-colors hover:text-neutral-700 dark:hover:text-neutral-200" data-tab="source-configs" onclick="window._pages.knowledge.showTab('source-configs')" data-i18n="sources.tabConfigs">Конфигурации</button>
                    <button class="px-4 py-2 text-sm text-neutral-500 dark:text-neutral-400 border-b-2 border-transparent -mb-px cursor-pointer transition-colors hover:text-neutral-700 dark:hover:text-neutral-200" data-tab="scraper" onclick="window._pages.knowledge.showTab('scraper')" data-i18n="sources.tabScraper">Скрапер</button>
                    <button class="px-4 py-2 text-sm text-neutral-500 dark:text-neutral-400 border-b-2 border-transparent -mb-px cursor-pointer transition-colors hover:text-neutral-700 dark:hover:text-neutral-200" data-tab="watched" onclick="window._pages.knowledge.showTab('watched')" data-i18n="sources.tabWatched">Отслеживаемые</button>
                </div>

                <!-- Tab: Articles -->
                <div id="knowledgeContent-articles">
                    <div class="flex flex-wrap items-center gap-2 mb-4">
                        <select id="kbCategory" onchange="window._pages.knowledge.loadArticles(0)" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                            <option value="" data-i18n="knowledge.allCategories">Все категории</option>
                        </select>
                        <select id="kbActive" onchange="window._pages.knowledge.loadArticles(0)" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                            <option value="" data-i18n="knowledge.allActive">Все</option>
                            <option value="true" data-i18n="knowledge.activeOnly">Активные</option>
                            <option value="false" data-i18n="knowledge.inactiveOnly">Неактивные</option>
                        </select>
                        <input type="text" id="kbSearch" data-i18n-placeholder="knowledge.searchPlaceholder" placeholder="Поиск..."
                            onkeydown="if(event.key==='Enter')window._pages.knowledge.loadArticles(0)"
                            class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                        <button onclick="window._pages.knowledge.loadArticles(0)"
                            class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700 max-md:w-full" data-i18n="common.filter">Фильтровать</button>
                        <button onclick="window._pages.knowledge.showCreateArticle()"
                            class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700 max-md:w-full" data-i18n="knowledge.newArticle">+ Новая статья</button>
                        <button onclick="window._pages.knowledge.reindexAll()"
                            class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-emerald-600 text-white hover:bg-emerald-700 max-md:w-full" data-i18n="knowledge.reindexAll">Переиндексировать всё</button>
                        <button onclick="window._pages.knowledge.showImportModal()"
                            class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-violet-600 text-white hover:bg-violet-700 max-md:w-full" data-i18n="knowledge.importDocuments">Импорт документов</button>
                    </div>
                    <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4" id="articlesContainer"></div>
                    <div id="articlesPagination"></div>
                </div>

                <!-- Tab: Source Configs -->
                <div id="knowledgeContent-source-configs" style="display:none">
                    <h3 class="text-lg font-semibold text-neutral-900 dark:text-neutral-100 mb-3" data-i18n="sources.sourceConfigsTitle">Источники контента</h3>
                    <p class="text-sm text-neutral-500 dark:text-neutral-400 mb-3" data-i18n="sources.sourceConfigsHint">Внешние сайты для сбора статей в базу знаний.</p>
                    <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4" id="sourceConfigsContainer"></div>
                    <div id="sourceConfigsPagination"></div>
                </div>

                <!-- Tab: Scraper -->
                <div id="knowledgeContent-scraper" style="display:none">
                    <h3 class="text-lg font-semibold text-neutral-900 dark:text-neutral-100 mb-3" data-i18n="sources.scraperConfigTitle">ProKoleso — ручной импорт</h3>
                    <div id="scraperConfigCard" class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4"></div>
                    <div class="flex flex-wrap items-center gap-2 mb-4">
                        <select id="sourcesStatusFilter" onchange="window._pages.knowledge.loadSources(0)" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                            <option value="" data-i18n="sources.allStatuses">Все статусы</option>
                            <option value="new">new</option>
                            <option value="processing">processing</option>
                            <option value="processed">processed</option>
                            <option value="skipped">skipped</option>
                            <option value="error">error</option>
                        </select>
                        <button onclick="window._pages.knowledge.loadSources(0)"
                            class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700 max-md:w-full" data-i18n="common.filter">Фильтровать</button>
                    </div>
                    <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4" id="sourcesContainer"></div>
                    <div id="sourcesPagination"></div>
                </div>

                <!-- Tab: Watched Pages -->
                <div id="knowledgeContent-watched" style="display:none">
                    <h3 class="text-lg font-semibold text-neutral-900 dark:text-neutral-100 mb-3" data-i18n="sources.watchedPagesTitle">Отслеживаемые страницы</h3>
                    <p class="text-sm text-neutral-500 dark:text-neutral-400 mb-3" data-i18n="sources.watchedPagesHint">Страницы сайта, которые периодически пересканируются для обновления базы знаний агента.</p>
                    <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4" id="watchedPagesContainer"></div>
                    <div id="watchedPagesPagination"></div>
                </div>
            </div>

            <!-- Scenarios (Templates + Dialogues + Safety) -->
            <div id="page-scenarios" style="display:none">
                <div class="text-xs text-neutral-500 dark:text-neutral-400 mb-3"><a href="#/dashboard" class="text-blue-600 dark:text-blue-400 hover:underline">Home</a> / <span data-i18n="nav.training">Обучение</span> / <span data-i18n="nav.scenarios">Сценарии</span></div>
                <div class="flex items-center gap-2 mb-4">
                    <h1 class="text-lg font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="nav.scenarios">Сценарии</h1>
                    <button onclick="window._app.openHelp('scenarios')" class="w-6 h-6 rounded-full border border-neutral-300 dark:border-neutral-600 text-neutral-400 hover:text-blue-600 hover:border-blue-400 dark:hover:text-blue-400 dark:hover:border-blue-400 text-xs font-bold transition-colors flex items-center justify-center" title="Help">?</button>
                </div>
                <div class="tab-bar flex border-b border-neutral-200 dark:border-neutral-700 mb-4 flex-wrap">
                    <button class="active px-4 py-2 text-sm text-neutral-500 dark:text-neutral-400 border-b-2 border-transparent -mb-px cursor-pointer transition-colors hover:text-neutral-700 dark:hover:text-neutral-200" data-tab="templates" onclick="window._pages.scenarios.showTab('templates')" data-i18n="training.tabTemplates">Шаблоны ответов</button>
                    <button class="px-4 py-2 text-sm text-neutral-500 dark:text-neutral-400 border-b-2 border-transparent -mb-px cursor-pointer transition-colors hover:text-neutral-700 dark:hover:text-neutral-200" data-tab="dialogues" onclick="window._pages.scenarios.showTab('dialogues')" data-i18n="training.tabDialogues">Сценарии диалогов</button>
                    <button class="px-4 py-2 text-sm text-neutral-500 dark:text-neutral-400 border-b-2 border-transparent -mb-px cursor-pointer transition-colors hover:text-neutral-700 dark:hover:text-neutral-200" data-tab="safety" onclick="window._pages.scenarios.showTab('safety')" data-i18n="training.tabSafety">Правила безопасности</button>
                </div>

                <!-- Tab: Templates -->
                <div id="scenariosContent-templates">
                    <div class="flex flex-wrap items-center gap-2 mb-4">
                        <select id="templateFilterKey" onchange="window._pages.scenarios.loadTemplates()" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                            <option value="" data-i18n="training.allTemplateKeys">Все ключи</option>
                        </select>
                        <input type="text" id="templateSearch" data-i18n-placeholder="training.searchTemplates" placeholder="Поиск шаблонов..."
                            onkeydown="if(event.key==='Enter')window._pages.scenarios.loadTemplates()"
                            class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                        <button onclick="window._pages.scenarios.loadTemplates()"
                            class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700 max-md:w-full" data-i18n="common.filter">Фильтровать</button>
                    </div>
                    <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4" id="templatesContainer"></div>
                    <div id="templatesPagination"></div>
                </div>

                <!-- Tab: Dialogues -->
                <div id="scenariosContent-dialogues" style="display:none">
                    <div class="flex flex-wrap items-center gap-2 mb-4">
                        <select id="dialogueFilterScenario" onchange="window._pages.scenarios.loadDialogues(0)" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                            <option value="" data-i18n="training.allScenarios">Все сценарии</option>
                            <option value="tire_search">tire_search</option>
                            <option value="order_status">order_status</option>
                            <option value="order_creation">order_creation</option>
                            <option value="fitting_booking">fitting_booking</option>
                            <option value="consultation">consultation</option>
                            <option value="transfer">transfer</option>
                        </select>
                        <select id="dialogueFilterPhase" onchange="window._pages.scenarios.loadDialogues(0)" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                            <option value="" data-i18n="training.allPhases">Все фазы</option>
                            <option value="mvp">mvp</option>
                            <option value="orders">orders</option>
                            <option value="services">services</option>
                            <option value="analytics">analytics</option>
                        </select>
                        <select id="dialogueFilterActive" onchange="window._pages.scenarios.loadDialogues(0)" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                            <option value="" data-i18n="training.allActive">Все</option>
                            <option value="true" data-i18n="training.activeOnly">Активные</option>
                            <option value="false" data-i18n="training.inactiveOnly">Неактивные</option>
                        </select>
                        <button onclick="window._pages.scenarios.loadDialogues(0)"
                            class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700 max-md:w-full" data-i18n="common.filter">Фильтровать</button>
                    </div>
                    <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4" id="dialoguesContainer"></div>
                    <div id="dialoguesPagination"></div>
                </div>

                <!-- Tab: Safety Rules -->
                <div id="scenariosContent-safety" style="display:none">
                    <div class="flex flex-wrap items-center gap-2 mb-4">
                        <select id="safetyFilterType" onchange="window._pages.scenarios.loadSafetyRules(0)" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                            <option value="" data-i18n="training.allRuleTypes">Все типы</option>
                            <option value="behavioral">behavioral</option>
                            <option value="content">content</option>
                            <option value="language">language</option>
                            <option value="privacy">privacy</option>
                            <option value="boundary">boundary</option>
                        </select>
                        <select id="safetyFilterSeverity" onchange="window._pages.scenarios.loadSafetyRules(0)" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                            <option value="" data-i18n="training.allSeverities">Все</option>
                            <option value="critical">critical</option>
                            <option value="high">high</option>
                            <option value="medium">medium</option>
                            <option value="low">low</option>
                        </select>
                        <select id="safetyFilterActive" onchange="window._pages.scenarios.loadSafetyRules(0)" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                            <option value="" data-i18n="training.allActive">Все</option>
                            <option value="true" data-i18n="training.activeOnly">Активные</option>
                            <option value="false" data-i18n="training.inactiveOnly">Неактивные</option>
                        </select>
                        <button onclick="window._pages.scenarios.loadSafetyRules(0)"
                            class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700 max-md:w-full" data-i18n="common.filter">Фильтровать</button>
                    </div>
                    <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4" id="safetyRulesContainer"></div>
                    <div id="safetyPagination"></div>
                </div>
            </div>

            <!-- Tools -->
            <div id="page-tools" style="display:none">
                <div class="text-xs text-neutral-500 dark:text-neutral-400 mb-3"><a href="#/dashboard" class="text-blue-600 dark:text-blue-400 hover:underline">Home</a> / <span data-i18n="nav.training">Обучение</span> / <span data-i18n="nav.tools">Инструменты</span></div>
                <div class="flex items-center gap-2 mb-4">
                    <h1 class="text-lg font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="nav.tools">Инструменты</h1>
                    <button onclick="window._app.openHelp('tools')" class="w-6 h-6 rounded-full border border-neutral-300 dark:border-neutral-600 text-neutral-400 hover:text-blue-600 hover:border-blue-400 dark:hover:text-blue-400 dark:hover:border-blue-400 text-xs font-bold transition-colors flex items-center justify-center" title="Help">?</button>
                </div>
                <div id="toolsContent" class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4"></div>
                <div id="toolsPagination"></div>
            </div>

            <!-- Sandbox -->
            <div id="page-sandbox" style="display:none">
                <div class="text-xs text-neutral-500 dark:text-neutral-400 mb-3"><a href="#/dashboard" class="text-blue-600 dark:text-blue-400 hover:underline">Home</a> / <span data-i18n="nav.training">Обучение</span> / <span data-i18n="nav.sandbox">Песочница</span></div>
                <div class="flex items-center gap-2 mb-4">
                    <h1 class="text-lg font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="sandbox.title">Песочница агента</h1>
                    <button onclick="window._app.openHelp('sandbox')" class="w-6 h-6 rounded-full border border-neutral-300 dark:border-neutral-600 text-neutral-400 hover:text-blue-600 hover:border-blue-400 dark:hover:text-blue-400 dark:hover:border-blue-400 text-xs font-bold transition-colors flex items-center justify-center" title="Help">?</button>
                </div>
                <div class="flex flex-col" style="height: calc(100vh - 140px);">
                    <div class="tab-bar flex border-b border-neutral-200 dark:border-neutral-700 mb-3">
                        <button class="active px-4 py-2 text-sm text-neutral-500 dark:text-neutral-400 border-b-2 border-transparent -mb-px cursor-pointer transition-colors hover:text-neutral-700 dark:hover:text-neutral-200" data-tab="chat" onclick="window._pages.sandbox.showTab('chat')" data-i18n="sandbox.tabChat">Чат</button>
                        <button class="px-4 py-2 text-sm text-neutral-500 dark:text-neutral-400 border-b-2 border-transparent -mb-px cursor-pointer transition-colors hover:text-neutral-700 dark:hover:text-neutral-200" data-tab="regression" onclick="window._pages.sandbox.showTab('regression')" data-i18n="sandbox.tabRegression">Регрессия</button>
                        <button class="px-4 py-2 text-sm text-neutral-500 dark:text-neutral-400 border-b-2 border-transparent -mb-px cursor-pointer transition-colors hover:text-neutral-700 dark:hover:text-neutral-200" data-tab="patterns" onclick="window._pages.sandbox.showTab('patterns')" data-i18n="sandbox.patterns">Паттерны</button>
                        <button class="px-4 py-2 text-sm text-neutral-500 dark:text-neutral-400 border-b-2 border-transparent -mb-px cursor-pointer transition-colors hover:text-neutral-700 dark:hover:text-neutral-200" data-tab="phrases" onclick="window._pages.sandbox.showTab('phrases')" data-i18n="sandbox.tabPhrases">Фразы агента</button>
                        <button class="px-4 py-2 text-sm text-neutral-500 dark:text-neutral-400 border-b-2 border-transparent -mb-px cursor-pointer transition-colors hover:text-neutral-700 dark:hover:text-neutral-200" data-tab="starters" onclick="window._pages.sandbox.showTab('starters')" data-i18n="sandbox.tabStarters">Шаблоны</button>
                    </div>
                    <!-- Chat tab: sidebar + chat area -->
                    <div id="sandboxContent-chat" class="flex-1 overflow-hidden flex gap-4">
                        <div id="sandboxSidebar" class="w-72 flex-shrink-0 flex flex-col border border-neutral-200 dark:border-neutral-800 rounded-lg bg-white dark:bg-neutral-900 overflow-hidden">
                            <div class="p-3 border-b border-neutral-200 dark:border-neutral-700 space-y-2">
                                <div class="flex gap-1">
                                    <button class="flex-1 inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700" onclick="window._pages.sandbox.showNewConvModal()" data-i18n="sandbox.newConversation">+ Новый диалог</button>
                                    <button class="px-2 py-1.5 text-sm rounded-md transition-colors cursor-pointer border border-neutral-300 dark:border-neutral-600 text-neutral-600 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800" onclick="window._pages.sandbox.showImportCallModal()" data-i18n="sandbox.importFromCall" title="Из звонка">&#128222;</button>
                                    <button id="sandboxBulkToggle" class="px-2 py-1.5 text-sm rounded-md transition-colors cursor-pointer border border-neutral-300 dark:border-neutral-600 text-neutral-600 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800" onclick="window._pages.sandbox.toggleBulkMode()" title="Bulk delete">&#9745;</button>
                                </div>
                                <input type="text" id="sandboxSearch" data-i18n-placeholder="sandbox.searchPlaceholder" placeholder="Поиск по названию..."
                                    onkeydown="if(event.key==='Enter')window._pages.sandbox.loadSidebar()"
                                    class="w-full px-2 py-1 text-xs border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <div class="flex gap-1">
                                    <select id="sandboxFilterStatus" onchange="window._pages.sandbox.loadSidebar()"
                                        class="flex-1 px-1.5 py-1 text-xs border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="" data-i18n="common.allStatuses">Все статусы</option>
                                        <option value="active" data-i18n="sandbox.active">Активный</option>
                                        <option value="archived" data-i18n="sandbox.archivedStatus">Архив</option>
                                    </select>
                                    <select id="sandboxFilterScenario" onchange="window._pages.sandbox.loadSidebar()"
                                        class="flex-1 px-1.5 py-1 text-xs border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="" data-i18n="common.all">Все</option>
                                        <option value="tire_search">tire_search</option>
                                        <option value="order_creation">order_creation</option>
                                        <option value="fitting_booking">fitting_booking</option>
                                        <option value="expert_consultation">expert_consultation</option>
                                        <option value="operator_transfer">operator_transfer</option>
                                    </select>
                                </div>
                            </div>
                            <div id="sandboxSidebarList" class="flex-1 overflow-y-auto"></div>
                        </div>
                        <div id="sandboxChatContainer" class="flex-1 min-w-0 bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 overflow-y-auto"></div>
                    </div>
                    <!-- Other tabs: full width -->
                    <div id="sandboxContent-regression" style="display:none" class="flex-1 overflow-auto">
                        <div id="sandboxRegressionContainer" class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5"></div>
                    </div>
                    <div id="sandboxContent-patterns" style="display:none" class="flex-1 overflow-auto">
                        <div id="sandboxPatternsContainer" class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5"></div>
                    </div>
                    <div id="sandboxContent-phrases" style="display:none" class="flex-1 overflow-auto">
                        <div id="sandboxPhrasesContainer" class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5"></div>
                    </div>
                    <div id="sandboxContent-starters" style="display:none" class="flex-1 overflow-auto">
                        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5">
                            <div class="flex flex-wrap items-center gap-2 mb-4">
                                <input type="text" id="starterSearch"
                                    data-i18n-placeholder="sandbox.searchStarters"
                                    placeholder="Поиск по шаблонам..."
                                    class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full flex-1 min-w-[180px]"
                                    onkeydown="if(event.key==='Enter')window._pages.sandbox.loadStarters(0)">
                                <select id="starterFilterScenario" onchange="window._pages.sandbox.loadStarters(0)" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                                    <option value="" data-i18n="sandbox.allScenarios">Все сценарии</option>
                                    <option value="tire_search">tire_search</option>
                                    <option value="order_creation">order_creation</option>
                                    <option value="fitting_booking">fitting_booking</option>
                                    <option value="expert_consultation">expert_consultation</option>
                                    <option value="operator_transfer">operator_transfer</option>
                                </select>
                                <select id="starterFilterActive" onchange="window._pages.sandbox.loadStarters(0)" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                                    <option value="" data-i18n="sandbox.allStatuses">Все статусы</option>
                                    <option value="true" data-i18n="sandbox.activeOnly">Активные</option>
                                    <option value="false" data-i18n="sandbox.inactiveOnly">Неактивные</option>
                                </select>
                                <button class="px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition-colors" onclick="window._pages.sandbox.showStarterModal()">+ <span data-i18n="sandbox.newStarter">Новый шаблон</span></button>
                            </div>
                            <div id="sandboxStartersContainer"></div>
                            <div id="startersPagination" class="mt-4"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Operators -->
            <div id="page-operators" style="display:none">
                <div class="text-xs text-neutral-500 dark:text-neutral-400 mb-3"><a href="#/dashboard" class="text-blue-600 dark:text-blue-400 hover:underline">Home</a> / <span data-i18n="operators.breadcrumb">Операторы</span></div>
                <div class="flex items-center gap-2 mb-4">
                    <h1 class="text-lg font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="operators.title">Операторы</h1>
                    <button onclick="window._app.openHelp('operators')" class="w-6 h-6 rounded-full border border-neutral-300 dark:border-neutral-600 text-neutral-400 hover:text-blue-600 hover:border-blue-400 dark:hover:text-blue-400 dark:hover:border-blue-400 text-xs font-bold transition-colors flex items-center justify-center" title="Help">?</button>
                </div>
                <div class="grid grid-cols-[repeat(auto-fill,minmax(180px,1fr))] gap-4 mb-6 max-md:grid-cols-2 max-[480px]:grid-cols-1" id="operatorQueueStats"></div>
                <div class="flex flex-wrap items-center gap-2 mb-4">
                    <input type="text" id="operatorSearch" data-i18n-placeholder="operators.searchPlaceholder" placeholder="Поиск по имени/номеру..."
                        onkeydown="if(event.key==='Enter')window._pages.operators.loadOperators()"
                        class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                    <select id="operatorFilterStatus" onchange="window._pages.operators.loadOperators()" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                        <option value="" data-i18n="operators.allStatuses">Все статусы</option>
                        <option value="online">online</option>
                        <option value="offline">offline</option>
                        <option value="busy">busy</option>
                        <option value="break">break</option>
                    </select>
                    <button onclick="window._pages.operators.showCreateOperator()"
                        class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700 max-md:w-full" data-i18n="operators.newOperator">+ Новый оператор</button>
                </div>
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4 relative">
                    <div id="operatorsLoading" class="flex justify-center py-8" style="display:none"><div class="spinner"></div></div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm" id="operatorsTable">
                            <thead>
                                <tr>
                                    <th class="px-3 py-2.5 text-left text-xs font-semibold text-neutral-500 dark:text-neutral-400 uppercase tracking-wider border-b border-neutral-200 dark:border-neutral-700" data-i18n="operators.name" data-sortable>Имя</th>
                                    <th class="px-3 py-2.5 text-left text-xs font-semibold text-neutral-500 dark:text-neutral-400 uppercase tracking-wider border-b border-neutral-200 dark:border-neutral-700" data-i18n="operators.extension" data-sortable>Внутр. номер</th>
                                    <th class="px-3 py-2.5 text-left text-xs font-semibold text-neutral-500 dark:text-neutral-400 uppercase tracking-wider border-b border-neutral-200 dark:border-neutral-700" data-i18n="operators.status" data-sortable>Статус</th>
                                    <th class="px-3 py-2.5 text-left text-xs font-semibold text-neutral-500 dark:text-neutral-400 uppercase tracking-wider border-b border-neutral-200 dark:border-neutral-700" data-i18n="operators.skills">Навыки</th>
                                    <th class="px-3 py-2.5 text-left text-xs font-semibold text-neutral-500 dark:text-neutral-400 uppercase tracking-wider border-b border-neutral-200 dark:border-neutral-700" data-i18n="operators.shift" data-sortable>Смена</th>
                                    <th class="px-3 py-2.5 text-left text-xs font-semibold text-neutral-500 dark:text-neutral-400 uppercase tracking-wider border-b border-neutral-200 dark:border-neutral-700" data-i18n="operators.activeCol" data-sortable>Активен</th>
                                    <th class="px-3 py-2.5 text-left text-xs font-semibold text-neutral-500 dark:text-neutral-400 uppercase tracking-wider border-b border-neutral-200 dark:border-neutral-700" data-i18n="operators.actionsCol">Действия</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Monitoring -->
            <div id="page-monitoring" style="display:none">
                <div class="text-xs text-neutral-500 dark:text-neutral-400 mb-3"><a href="#/dashboard" class="text-blue-600 dark:text-blue-400 hover:underline">Home</a> / <span data-i18n="nav.system">Система</span> / <span data-i18n="nav.monitoring">Мониторинг</span></div>
                <div class="flex items-center gap-2 mb-4">
                    <h1 class="text-lg font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="nav.monitoring">Мониторинг</h1>
                    <button onclick="window._app.openHelp('monitoring')" class="w-6 h-6 rounded-full border border-neutral-300 dark:border-neutral-600 text-neutral-400 hover:text-blue-600 hover:border-blue-400 dark:hover:text-blue-400 dark:hover:border-blue-400 text-xs font-bold transition-colors flex items-center justify-center" title="Help">?</button>
                </div>
                <!-- Health check (open) -->
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg mb-4 acc-section" data-open="true">
                    <button type="button" onclick="window._app.toggleAccordion(this)" class="w-full flex items-center justify-between px-5 py-3.5 text-left cursor-pointer hover:bg-neutral-50 dark:hover:bg-neutral-800/50 rounded-lg transition-colors">
                        <h3 class="text-sm font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="settings.healthCheck">Проверка здоровья</h3>
                        <svg class="w-4 h-4 text-neutral-400 transition-transform acc-chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"/></svg>
                    </button>
                    <div class="acc-body px-5 pb-5">
                        <div id="systemInfo"><div class="flex justify-center py-8"><div class="spinner"></div></div></div>
                        <button class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700 mt-3" onclick="window._pages.monitoring.loadSettings()" data-i18n="settings.refresh">Обновить</button>
                    </div>
                </div>
                <!-- Extended status (collapsed) -->
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg mb-4 admin-only acc-section" data-open="false">
                    <button type="button" onclick="window._app.toggleAccordion(this)" class="w-full flex items-center justify-between px-5 py-3.5 text-left cursor-pointer hover:bg-neutral-50 dark:hover:bg-neutral-800/50 rounded-lg transition-colors">
                        <h3 class="text-sm font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="settings.extendedStatus">Расширенный статус</h3>
                        <svg class="w-4 h-4 text-neutral-400 transition-transform acc-chevron rotate-[-90deg]" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"/></svg>
                    </button>
                    <div class="acc-body px-5 pb-5" style="display:none">
                        <div id="extendedStatus"><div class="text-center py-8 text-neutral-400 dark:text-neutral-500 text-sm" data-i18n="settings.clickToLoad">Нажмите для загрузки</div></div>
                        <button class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700 mt-3" onclick="window._pages.monitoring.loadSystemStatus()" data-i18n="settings.loadStatus">Загрузить статус</button>
                    </div>
                </div>
                <!-- External tools (collapsed) -->
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg mb-4 acc-section" data-open="false">
                    <button type="button" onclick="window._app.toggleAccordion(this)" class="w-full flex items-center justify-between px-5 py-3.5 text-left cursor-pointer hover:bg-neutral-50 dark:hover:bg-neutral-800/50 rounded-lg transition-colors">
                        <h3 class="text-sm font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="settings.externalTools">Внешние инструменты</h3>
                        <svg class="w-4 h-4 text-neutral-400 transition-transform acc-chevron rotate-[-90deg]" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"/></svg>
                    </button>
                    <div class="acc-body px-5 pb-5" style="display:none">
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm" id="externalToolsTable">
                                <tr class="hover:bg-neutral-50 dark:hover:bg-neutral-800/50 transition-colors"><td class="px-3 py-2.5 border-b border-neutral-100 dark:border-neutral-800 text-neutral-700 dark:text-neutral-300">Grafana</td><td class="px-3 py-2.5 border-b border-neutral-100 dark:border-neutral-800"><a data-tool-port="3000" href="#" target="_blank" class="text-blue-600 dark:text-blue-400 hover:underline" data-i18n="settings.openGrafana">Открыть Grafana</a></td></tr>
                                <tr class="hover:bg-neutral-50 dark:hover:bg-neutral-800/50 transition-colors"><td class="px-3 py-2.5 border-b border-neutral-100 dark:border-neutral-800 text-neutral-700 dark:text-neutral-300">Prometheus</td><td class="px-3 py-2.5 border-b border-neutral-100 dark:border-neutral-800"><a data-tool-port="9090" href="#" target="_blank" class="text-blue-600 dark:text-blue-400 hover:underline" data-i18n="settings.openPrometheus">Открыть Prometheus</a></td></tr>
                                <tr class="hover:bg-neutral-50 dark:hover:bg-neutral-800/50 transition-colors"><td class="px-3 py-2.5 border-b border-neutral-100 dark:border-neutral-800 text-neutral-700 dark:text-neutral-300">Flower (Celery)</td><td class="px-3 py-2.5 border-b border-neutral-100 dark:border-neutral-800"><a data-tool-path="/flower/" href="/flower/" target="_blank" class="text-blue-600 dark:text-blue-400 hover:underline" data-i18n="settings.openFlower">Открыть Flower</a></td></tr>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- App info (collapsed) -->
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg mb-4 acc-section" data-open="false">
                    <button type="button" onclick="window._app.toggleAccordion(this)" class="w-full flex items-center justify-between px-5 py-3.5 text-left cursor-pointer hover:bg-neutral-50 dark:hover:bg-neutral-800/50 rounded-lg transition-colors">
                        <h3 class="text-sm font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="settings.appInfo">Информация о приложении</h3>
                        <svg class="w-4 h-4 text-neutral-400 transition-transform acc-chevron rotate-[-90deg]" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"/></svg>
                    </button>
                    <div class="acc-body px-5 pb-5" style="display:none">
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <tr><td class="px-3 py-2.5 border-b border-neutral-100 dark:border-neutral-800 text-neutral-700 dark:text-neutral-300" data-i18n="settings.version">Версия</td><td class="px-3 py-2.5 border-b border-neutral-100 dark:border-neutral-800 text-neutral-700 dark:text-neutral-300">v0.1.0</td></tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Configuration -->
            <div id="page-configuration" style="display:none">
                <div class="text-xs text-neutral-500 dark:text-neutral-400 mb-3"><a href="#/dashboard" class="text-blue-600 dark:text-blue-400 hover:underline">Home</a> / <span data-i18n="nav.system">Система</span> / <span data-i18n="nav.configuration">Конфигурация</span></div>
                <div class="flex items-center gap-2 mb-4">
                    <h1 class="text-lg font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="nav.configuration">Конфигурация</h1>
                    <button onclick="window._app.openHelp('configuration')" class="w-6 h-6 rounded-full border border-neutral-300 dark:border-neutral-600 text-neutral-400 hover:text-blue-600 hover:border-blue-400 dark:hover:text-blue-400 dark:hover:border-blue-400 text-xs font-bold transition-colors flex items-center justify-center" title="Help">?</button>
                </div>
                <!-- Config reload (open) -->
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg mb-4 admin-only acc-section" data-open="true">
                    <button type="button" onclick="window._app.toggleAccordion(this)" class="w-full flex items-center justify-between px-5 py-3.5 text-left cursor-pointer hover:bg-neutral-50 dark:hover:bg-neutral-800/50 rounded-lg transition-colors">
                        <h3 class="text-sm font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="settings.configuration">Конфигурация</h3>
                        <svg class="w-4 h-4 text-neutral-400 transition-transform acc-chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"/></svg>
                    </button>
                    <div class="acc-body px-5 pb-5">
                        <p class="text-sm text-neutral-500 dark:text-neutral-400 mb-3" data-i18n="settings.configDescription">Перезагрузить безопасные параметры конфигурации (качество, фича-флаги, логирование) без перезапуска.</p>
                        <button class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700" onclick="window._pages.configuration.reloadConfig()" data-i18n="settings.reloadConfig">Перезагрузить конфиг</button>
                    </div>
                </div>
                <!-- LLM Routing (open — main content) -->
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg mb-4 admin-only acc-section" data-open="true">
                    <button type="button" onclick="window._app.toggleAccordion(this)" class="w-full flex items-center justify-between px-5 py-3.5 text-left cursor-pointer hover:bg-neutral-50 dark:hover:bg-neutral-800/50 rounded-lg transition-colors">
                        <h3 class="text-sm font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="settings.llmRouting">Маршрутизация LLM</h3>
                        <svg class="w-4 h-4 text-neutral-400 transition-transform acc-chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"/></svg>
                    </button>
                    <div class="acc-body px-5 pb-5">
                        <p class="text-sm text-neutral-500 dark:text-neutral-400 mb-3" data-i18n="settings.llmRoutingDesc">Мультипровайдерный роутинг LLM: управление провайдерами, задачами и fallback-цепочками.</p>
                        <div id="llmProvidersContainer"><div class="text-center py-4 text-neutral-400 dark:text-neutral-500 text-sm" data-i18n="settings.clickToLoad">Нажмите для загрузки</div></div>
                        <div id="llmTasksContainer" class="mt-4"></div>
                        <button class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700 mt-3" onclick="window._pages.configuration.loadLLMConfig()" data-i18n="settings.llmLoadConfig">Загрузить конфигурацию</button>
                    </div>
                </div>
            </div>

            <!-- Notifications -->
            <div id="page-notifications" style="display:none">
                <div class="text-xs text-neutral-500 dark:text-neutral-400 mb-3"><a href="#/dashboard" class="text-blue-600 dark:text-blue-400 hover:underline">Home</a> / <span data-i18n="nav.system">Система</span> / <span data-i18n="nav.notifications">Уведомления</span></div>
                <div class="flex items-center gap-2 mb-4">
                    <h1 class="text-lg font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="nav.notifications">Уведомления</h1>
                    <button onclick="window._app.openHelp('notifications')" class="w-6 h-6 rounded-full border border-neutral-300 dark:border-neutral-600 text-neutral-400 hover:text-blue-600 hover:border-blue-400 dark:hover:text-blue-400 dark:hover:border-blue-400 text-xs font-bold transition-colors flex items-center justify-center" title="Help">?</button>
                </div>
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4 admin-only">
                    <h3 class="text-sm font-semibold text-neutral-900 dark:text-neutral-50 mb-3" data-i18n="settings.telegram">Уведомления Telegram</h3>
                    <p class="text-sm text-neutral-500 dark:text-neutral-400 mb-3" data-i18n="settings.telegramDesc">Настройка Telegram-бота для получения алертов от Alertmanager.</p>
                    <div id="telegramConfigContainer"><div class="text-center py-4 text-neutral-400 dark:text-neutral-500 text-sm" data-i18n="settings.clickToLoad">Нажмите для загрузки</div></div>
                </div>
            </div>

            <!-- Tenants -->
            <div id="page-tenants" style="display:none">
                <div class="text-xs text-neutral-500 dark:text-neutral-400 mb-3"><a href="#/dashboard" class="text-blue-600 dark:text-blue-400 hover:underline">Home</a> / <span data-i18n="nav.system">Система</span> / <span data-i18n="nav.tenants">Сети</span></div>
                <div class="flex items-center gap-2 mb-4">
                    <h1 class="text-lg font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="tenants.title">Сети</h1>
                    <button onclick="window._app.openHelp('tenants')" class="w-6 h-6 rounded-full border border-neutral-300 dark:border-neutral-600 text-neutral-400 hover:text-blue-600 hover:border-blue-400 dark:hover:text-blue-400 dark:hover:border-blue-400 text-xs font-bold transition-colors flex items-center justify-center" title="Help">?</button>
                </div>
                <div class="flex flex-wrap items-center gap-2 mb-4">
                    <select id="tenantsActiveFilter" onchange="window._pages.tenants.loadTenants()" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                        <option value="" data-i18n="common.all">Все</option>
                        <option value="true" data-i18n="tenants.active">Активные</option>
                        <option value="false" data-i18n="tenants.inactive">Неактивные</option>
                    </select>
                    <button onclick="window._pages.tenants.showCreateTenant()"
                        class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700 max-md:w-full" data-i18n="tenants.newTenant">+ Новая сеть</button>
                </div>
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4" id="tenantsContainer">
                    <div class="flex justify-center py-8"><div class="spinner"></div></div>
                </div>
                <div class="pagination flex justify-center gap-1 mt-4" id="tenantsPagination"></div>
            </div>

            <!-- 1C Data -->
            <div id="page-onec-data" style="display:none">
                <div class="text-xs text-neutral-500 dark:text-neutral-400 mb-3"><a href="#/dashboard" class="text-blue-600 dark:text-blue-400 hover:underline">Home</a> / <span data-i18n="nav.system">Система</span> / <span data-i18n="nav.onecData">Данные 1С</span></div>
                <div class="flex items-center gap-2 mb-4">
                    <h1 class="text-lg font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="onec.title">Данные 1С</h1>
                </div>

                <!-- Status (open by default) -->
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg mb-4 acc-section" data-open="true">
                    <button type="button" onclick="window._pages['onec-data'].toggleSection(this)" class="w-full flex items-center justify-between px-5 py-3.5 text-left cursor-pointer hover:bg-neutral-50 dark:hover:bg-neutral-800/50 rounded-lg transition-colors">
                        <h3 class="text-sm font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="onec.statusTitle">Статус подключения</h3>
                        <svg class="w-4 h-4 text-neutral-400 transition-transform acc-chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"/></svg>
                    </button>
                    <div class="acc-body px-5 pb-5">
                        <div id="onecStatusContainer"><div class="flex justify-center py-4"><div class="spinner"></div></div></div>
                    </div>
                </div>

                <!-- Pickup points (collapsed by default) -->
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg mb-4 acc-section" data-open="false">
                    <button type="button" onclick="window._pages['onec-data'].toggleSection(this)" class="w-full flex items-center justify-between px-5 py-3.5 text-left cursor-pointer hover:bg-neutral-50 dark:hover:bg-neutral-800/50 rounded-lg transition-colors">
                        <h3 class="text-sm font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="onec.pickupPoints">Пункты выдачи</h3>
                        <svg class="w-4 h-4 text-neutral-400 transition-transform acc-chevron rotate-[-90deg]" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"/></svg>
                    </button>
                    <div class="acc-body px-5 pb-5" style="display:none">
                        <div class="flex flex-wrap items-center gap-2 mb-3">
                            <select id="onecPickupNetwork" onchange="window._pages['onec-data'].loadPickupPoints()" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="ProKoleso">ProKoleso</option>
                            </select>
                            <input id="onecPickupCity" type="text" placeholder="Київ" data-i18n-placeholder="onec.filterCity" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 w-40">
                            <button onclick="window._pages['onec-data'].loadPickupPoints()" class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700" data-i18n="common.filter">Фильтровать</button>
                            <button onclick="window._pages['onec-data'].refreshPickupFromOnec()" class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer border border-neutral-300 dark:border-neutral-600 text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800" data-i18n="onec.refresh">Обновить из 1С</button>
                        </div>
                        <div id="onecPickupContainer"><div class="text-center py-4 text-neutral-400 dark:text-neutral-500 text-sm" data-i18n="onec.clickToExpand">Нажмите для загрузки</div></div>
                    </div>
                </div>

                <!-- Stock lookup (collapsed by default) -->
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg mb-4 acc-section" data-open="false">
                    <button type="button" onclick="window._pages['onec-data'].toggleSection(this)" class="w-full flex items-center justify-between px-5 py-3.5 text-left cursor-pointer hover:bg-neutral-50 dark:hover:bg-neutral-800/50 rounded-lg transition-colors">
                        <h3 class="text-sm font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="onec.stockLookup">Остатки по SKU</h3>
                        <svg class="w-4 h-4 text-neutral-400 transition-transform acc-chevron rotate-[-90deg]" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"/></svg>
                    </button>
                    <div class="acc-body px-5 pb-5" style="display:none">
                        <div class="flex flex-wrap items-center gap-2 mb-3">
                            <select id="onecStockNetwork" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="ProKoleso">ProKoleso</option>
                            </select>
                            <input id="onecStockSku" type="text" placeholder="1234567" data-i18n-placeholder="onec.skuPlaceholder" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 w-48 font-mono">
                            <button onclick="window._pages['onec-data'].lookupStock()" class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700" data-i18n="onec.search">Найти</button>
                        </div>
                        <div id="onecStockResult"><div class="text-center py-4 text-neutral-400 dark:text-neutral-500 text-sm" data-i18n="onec.skuPlaceholder">Введите артикул для поиска</div></div>
                    </div>
                </div>
            </div>

            <!-- Tenant Modal -->
            <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="tenantModal">
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl shadow-2xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto">
                    <h2 class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" id="tenantModalTitle">Новая сеть</h2>
                    <input type="hidden" id="editTenantId">
                    <div class="space-y-3">
                        <div>
                            <label class="block text-xs font-medium text-neutral-600 dark:text-neutral-400 mb-1" data-i18n="tenants.slug">Slug</label>
                            <input id="tenantSlug" type="text" placeholder="prokoleso" class="w-full text-sm bg-white dark:bg-neutral-800 text-neutral-800 dark:text-neutral-200 border border-neutral-300 dark:border-neutral-600 rounded px-2 py-1.5 focus:outline-none focus:border-blue-500 font-mono">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-neutral-600 dark:text-neutral-400 mb-1" data-i18n="tenants.name">Название</label>
                            <input id="tenantName" type="text" placeholder="ProKoleso" class="w-full text-sm bg-white dark:bg-neutral-800 text-neutral-800 dark:text-neutral-200 border border-neutral-300 dark:border-neutral-600 rounded px-2 py-1.5 focus:outline-none focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-neutral-600 dark:text-neutral-400 mb-1" data-i18n="tenants.networkId">Network ID</label>
                            <input id="tenantNetworkId" type="text" placeholder="prokoleso" class="w-full text-sm bg-white dark:bg-neutral-800 text-neutral-800 dark:text-neutral-200 border border-neutral-300 dark:border-neutral-600 rounded px-2 py-1.5 focus:outline-none focus:border-blue-500 font-mono">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-neutral-600 dark:text-neutral-400 mb-1" data-i18n="tenants.extensions">Extensions (Asterisk)</label>
                            <input id="tenantExtensions" type="text" placeholder="7770, 7771" class="w-full text-sm bg-white dark:bg-neutral-800 text-neutral-800 dark:text-neutral-200 border border-neutral-300 dark:border-neutral-600 rounded px-2 py-1.5 focus:outline-none focus:border-blue-500 font-mono">
                            <p class="text-xs text-neutral-500 dark:text-neutral-400 mt-0.5" data-i18n="tenants.extensionsHint">Номера extensions через запятую</p>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-neutral-600 dark:text-neutral-400 mb-1" data-i18n="tenants.agentName">Имя агента</label>
                            <input id="tenantAgentName" type="text" value="Олена" class="w-full text-sm bg-white dark:bg-neutral-800 text-neutral-800 dark:text-neutral-200 border border-neutral-300 dark:border-neutral-600 rounded px-2 py-1.5 focus:outline-none focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-neutral-600 dark:text-neutral-400 mb-1" data-i18n="tenants.greeting">Приветствие</label>
                            <textarea id="tenantGreeting" rows="2" placeholder="Добрий день, вас вітає {agent_name}..." class="w-full text-sm bg-white dark:bg-neutral-800 text-neutral-800 dark:text-neutral-200 border border-neutral-300 dark:border-neutral-600 rounded px-2 py-1.5 focus:outline-none focus:border-blue-500"></textarea>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-neutral-600 dark:text-neutral-400 mb-1" data-i18n="tenants.enabledTools">Инструменты</label>
                            <div id="tenantToolsContainer" class="grid grid-cols-2 gap-1 max-h-40 overflow-y-auto border border-neutral-200 dark:border-neutral-700 rounded p-2"></div>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-neutral-600 dark:text-neutral-400 mb-1" data-i18n="tenants.promptSuffix">Суффикс промпта</label>
                            <textarea id="tenantPromptSuffix" rows="2" class="w-full text-sm bg-white dark:bg-neutral-800 text-neutral-800 dark:text-neutral-200 border border-neutral-300 dark:border-neutral-600 rounded px-2 py-1.5 focus:outline-none focus:border-blue-500"></textarea>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-neutral-600 dark:text-neutral-400 mb-1" data-i18n="tenants.config">Конфигурация (JSON)</label>
                            <textarea id="tenantConfig" rows="3" class="w-full text-sm font-mono bg-white dark:bg-neutral-800 text-neutral-800 dark:text-neutral-200 border border-neutral-300 dark:border-neutral-600 rounded px-2 py-1.5 focus:outline-none focus:border-blue-500">{}</textarea>
                        </div>
                        <label class="flex items-center gap-2 text-sm cursor-pointer">
                            <input type="checkbox" id="tenantIsActive" checked>
                            <span data-i18n="tenants.activeLabel">Активен</span>
                        </label>
                    </div>
                    <div class="flex justify-end gap-2 mt-4">
                        <button onclick="window._app.closeModal('tenantModal')" class="px-3 py-1.5 text-sm border border-neutral-300 dark:border-neutral-600 rounded-md text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 cursor-pointer" data-i18n="common.cancel">Отмена</button>
                        <button onclick="window._pages.tenants.saveTenant()" class="px-3 py-1.5 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer" data-i18n="common.save">Сохранить</button>
                    </div>
                </div>
            </div>

            <!-- Users -->
            <div id="page-users" style="display:none">
                <div class="text-xs text-neutral-500 dark:text-neutral-400 mb-3"><a href="#/dashboard" class="text-blue-600 dark:text-blue-400 hover:underline">Home</a> / <span data-i18n="users.breadcrumb">Пользователи</span></div>
                <div class="flex items-center gap-2 mb-4">
                    <h1 class="text-lg font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="users.title">Управление пользователями</h1>
                    <button onclick="window._app.openHelp('users')" class="w-6 h-6 rounded-full border border-neutral-300 dark:border-neutral-600 text-neutral-400 hover:text-blue-600 hover:border-blue-400 dark:hover:text-blue-400 dark:hover:border-blue-400 text-xs font-bold transition-colors flex items-center justify-center" title="Help">?</button>
                </div>
                <div class="flex flex-wrap items-center gap-2 mb-4">
                    <button onclick="window._pages.users.showCreateUser()"
                        class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700 max-md:w-full" data-i18n="users.newUser">+ Новый пользователь</button>
                </div>
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4" id="usersContainer">
                    <div class="flex justify-center py-8"><div class="spinner"></div></div>
                </div>
                <div id="usersPagination"></div>
            </div>

            <!-- Audit Log -->
            <div id="page-audit" style="display:none">
                <div class="text-xs text-neutral-500 dark:text-neutral-400 mb-3"><a href="#/dashboard" class="text-blue-600 dark:text-blue-400 hover:underline">Home</a> / <span data-i18n="audit.breadcrumb">Аудит</span></div>
                <div class="flex items-center gap-2 mb-4">
                    <h1 class="text-lg font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="audit.title">Журнал аудита</h1>
                    <button onclick="window._app.openHelp('audit')" class="w-6 h-6 rounded-full border border-neutral-300 dark:border-neutral-600 text-neutral-400 hover:text-blue-600 hover:border-blue-400 dark:hover:text-blue-400 dark:hover:border-blue-400 text-xs font-bold transition-colors flex items-center justify-center" title="Help">?</button>
                </div>
                <div class="flex flex-wrap items-center gap-2 mb-4">
                    <input type="date" id="auditDateFrom" onchange="window._pages.audit.loadAuditLog()" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                    <input type="date" id="auditDateTo" onchange="window._pages.audit.loadAuditLog()" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                    <select id="auditAction" onchange="window._pages.audit.loadAuditLog()" class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full">
                        <option value="" data-i18n="audit.allActions">Все действия</option>
                        <option value="POST">POST</option>
                        <option value="PATCH">PATCH</option>
                        <option value="DELETE">DELETE</option>
                    </select>
                    <button onclick="window._pages.audit.loadAuditLog()"
                        class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700 max-md:w-full" data-i18n="common.filter">Фильтровать</button>
                </div>
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4" id="auditContainer">
                    <div class="flex justify-center py-8"><div class="spinner"></div></div>
                </div>
                <div class="pagination flex justify-center gap-1 mt-4" id="auditPagination"></div>
            </div>

            <!-- Vehicles -->
            <div id="page-vehicles" style="display:none">
                <div class="text-xs text-neutral-500 dark:text-neutral-400 mb-3">
                    <a href="#/dashboard" class="text-blue-600 dark:text-blue-400 hover:underline">Home</a> /
                    <span data-i18n="vehicles.breadcrumb">База авто</span>
                </div>
                <div class="flex items-center gap-2 mb-4">
                    <h1 class="text-lg font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="vehicles.title">База автомобилей</h1>
                    <button onclick="window._app.openHelp('vehicles')" class="w-6 h-6 rounded-full border border-neutral-300 dark:border-neutral-600 text-neutral-400 hover:text-blue-600 hover:border-blue-400 dark:hover:text-blue-400 dark:hover:border-blue-400 text-xs font-bold transition-colors flex items-center justify-center" title="Help">?</button>
                </div>
                <div id="vehiclesStats" class="grid grid-cols-[repeat(auto-fill,minmax(180px,1fr))] gap-4 mb-6 max-md:grid-cols-2 max-[480px]:grid-cols-1"></div>
                <div class="flex flex-wrap items-center gap-2 mb-4">
                    <input type="text" id="vehiclesSearch" placeholder="Поиск по названию..."
                        onkeydown="if(event.key==='Enter')window._pages.vehicles.search()"
                        class="px-2.5 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 max-md:w-full"
                        data-i18n-placeholder="vehicles.searchPlaceholder">
                    <button onclick="window._pages.vehicles.search()"
                        class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700 max-md:w-full" data-i18n="common.search">Поиск</button>
                    <button onclick="window._pages.vehicles.openImportModal()"
                        class="admin-only inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-violet-600 text-white hover:bg-violet-700 max-md:w-full" data-i18n="vehicles.importButton">Обновить БД</button>
                </div>
                <div id="vehiclesBreadcrumb" class="text-xs text-neutral-500 dark:text-neutral-400 mb-3" style="display:none"></div>
                <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-lg p-5 mb-4" id="vehiclesContainer">
                    <div class="flex justify-center py-8"><div class="spinner"></div></div>
                </div>
                <div class="pagination flex justify-center gap-1 mt-4" id="vehiclesPagination"></div>
            </div>
        </div>
    </div>

    <!-- New Conversation Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="sandboxNewConvModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-md w-[90%] max-h-[80vh] overflow-y-auto">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('sandboxNewConvModal')">&times;</span>
            <h3 class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" data-i18n="sandbox.newConversation">Новый диалог</h3>
            <div id="sandboxStartersSection" class="mb-4" style="display:none">
                <div class="text-xs font-semibold text-neutral-500 dark:text-neutral-400 mb-2" data-i18n="sandbox.quickStart">Быстрый старт</div>
                <div id="sandboxStarterCards" class="grid grid-cols-2 gap-2 mb-2"></div>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.conversationTitle">Название</label>
                <input type="text" id="sandboxConvTitle" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.promptVersion">Версия промпта</label>
                <select id="sandboxConvPrompt" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="" data-i18n="sandbox.promptVersionDefault">Активная версия</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.model">Модель</label>
                <select id="sandboxConvModel" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="" data-i18n="sandbox.modelDefault">По умолчанию</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.toolMode">Режим инструментов</label>
                <select id="sandboxConvToolMode" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="live" data-i18n="sandbox.toolModeLive">Живой (Store API)</option>
                    <option value="mock" data-i18n="sandbox.toolModeMock">Мок (тестовые данные)</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.scenarioType">Тип сценария</label>
                <select id="sandboxConvScenario" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="" data-i18n="sandbox.scenarioNone">Без типа</option>
                    <option value="tire_search">tire_search</option>
                    <option value="order_creation">order_creation</option>
                    <option value="fitting_booking">fitting_booking</option>
                    <option value="expert_consultation">expert_consultation</option>
                    <option value="operator_transfer">operator_transfer</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.tags">Теги</label>
                <input type="text" id="sandboxConvTags" placeholder="tag1, tag2" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <button onclick="window._pages.sandbox.createConversation()" class="w-full py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors cursor-pointer" data-i18n="sandbox.createConversation">Создать диалог</button>
        </div>
    </div>

    <!-- Turn Group Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="sandboxGroupModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-md w-[90%] max-h-[80vh] overflow-y-auto">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('sandboxGroupModal')">&times;</span>
            <h3 class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" data-i18n="sandbox.createGroup">Создать группу</h3>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.intentLabel">Интент</label>
                <input type="text" id="sandboxGroupIntent" placeholder="tire_search_clarification" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.patternType">Тип паттерна</label>
                <select id="sandboxGroupType" onchange="document.getElementById('sandboxGroupCorrectionWrap').style.display=this.value==='negative'?'block':'none'" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="positive">Positive</option>
                    <option value="negative">Negative</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.avgRating">Оценка</label>
                <select id="sandboxGroupRating" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="">-</option>
                    <option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.rateComment">Комментарий</label>
                <textarea id="sandboxGroupComment" rows="2" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
            </div>
            <div class="mb-3" id="sandboxGroupCorrectionWrap" style="display:none">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.correction">Исправление</label>
                <textarea id="sandboxGroupCorrection" rows="3" placeholder="" data-i18n-placeholder="sandbox.correctionHint" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.tags">Теги</label>
                <input type="text" id="sandboxGroupTags" placeholder="tag1, tag2" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <button onclick="window._pages.sandbox.submitGroup()" class="w-full py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors cursor-pointer" data-i18n="sandbox.createGroup">Создать группу</button>
        </div>
    </div>

    <!-- Export Pattern Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="sandboxExportModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-md w-[90%] max-h-[80vh] overflow-y-auto">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('sandboxExportModal')">&times;</span>
            <h3 class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" data-i18n="sandbox.exportToPatterns">Экспорт в паттерны</h3>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.guidanceNote">Инструкция для промпта</label>
                <textarea id="sandboxExportGuidance" rows="4" placeholder="" data-i18n-placeholder="sandbox.guidanceHint" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
            </div>
            <input type="hidden" id="sandboxExportGroupId">
            <button onclick="window._pages.sandbox.submitExport()" class="w-full py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors cursor-pointer" data-i18n="sandbox.exportToPatterns">Экспорт в паттерны</button>
        </div>
    </div>

    <!-- Branch Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="sandboxBranchModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-md w-[90%] max-h-[80vh] overflow-y-auto">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('sandboxBranchModal')">&times;</span>
            <h3 id="sandboxBranchTitle" class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" data-i18n="sandbox.branchMessage">Сообщение для ветки</h3>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.branchMessage">Сообщение</label>
                <textarea id="sandboxBranchInput" rows="3" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
            </div>
            <button onclick="window._pages.sandbox.submitBranch()" class="w-full py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors cursor-pointer" data-i18n="sandbox.submitBranch">Отправить</button>
        </div>
    </div>

    <!-- Replay Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="sandboxReplayModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-md w-[90%] max-h-[80vh] overflow-y-auto">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('sandboxReplayModal')">&times;</span>
            <h3 class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" data-i18n="sandbox.selectPromptForReplay">Выберите версию промпта для регрессии</h3>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.promptVersion">Версия промпта</label>
                <select id="sandboxReplayPrompt" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500"></select>
            </div>
            <input type="hidden" id="sandboxReplayConvId">
            <button onclick="window._pages.sandbox.submitReplay()" class="w-full py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors cursor-pointer" data-i18n="sandbox.submitReplay">Запустить</button>
        </div>
    </div>

    <!-- Import Call Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="sandboxImportCallModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-6xl w-[95%] max-h-[85vh] overflow-hidden flex flex-col">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-base font-semibold text-neutral-900 dark:text-neutral-50" data-i18n="sandbox.importFromCall">Из звонка</h3>
                <span class="cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('sandboxImportCallModal')">&times;</span>
            </div>
            <div class="flex gap-2 mb-3 flex-wrap">
                <input type="text" id="importCallSearch" data-i18n-placeholder="sandbox.importCallSearchPlaceholder" placeholder="Поиск по номеру..."
                    onkeydown="if(event.key==='Enter')window._pages.sandbox.loadImportCalls(0)"
                    class="flex-1 min-w-[140px] px-3 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <input type="date" id="importCallDateFrom" class="px-2 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <input type="date" id="importCallDateTo" class="px-2 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <button class="px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700" onclick="window._pages.sandbox.loadImportCalls(0)" data-i18n="common.filter">Фильтр</button>
            </div>
            <div class="flex gap-4 flex-1 min-h-0">
                <!-- Left: calls table -->
                <div class="w-[55%] flex flex-col min-h-0">
                    <div id="importCallsTableContainer" class="overflow-y-auto flex-1"></div>
                    <div id="importCallsPagination" class="mt-2 flex-shrink-0"></div>
                </div>
                <!-- Right: transcript preview -->
                <div id="importCallPreviewPanel" class="w-[45%] flex flex-col min-h-0 border-l border-neutral-200 dark:border-neutral-700 pl-4">
                    <div id="importCallPreviewHeader" class="flex items-center justify-between mb-2 flex-shrink-0">
                        <h4 class="text-sm font-semibold text-neutral-700 dark:text-neutral-300" data-i18n="sandbox.importCallPreview">Расшифровка</h4>
                    </div>
                    <div id="importCallTranscript" class="overflow-y-auto flex-1 text-sm">
                        <p class="text-neutral-400 dark:text-neutral-500 text-center py-8" data-i18n="sandbox.importCallSelectToPreview">Выберите звонок для просмотра</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Starter Modal (CRUD) -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="sandboxStarterModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-md w-[90%] max-h-[80vh] overflow-y-auto">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('sandboxStarterModal')">&times;</span>
            <h3 id="sandboxStarterModalTitle" class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" data-i18n="sandbox.newStarter">Новый шаблон</h3>
            <input type="hidden" id="sandboxStarterEditId">
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.starterTitle">Название</label>
                <input type="text" id="sandboxStarterTitle" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.starterFirstMessage">Первое сообщение</label>
                <textarea id="sandboxStarterFirstMsg" rows="3" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.starterDescription">Описание</label>
                <input type="text" id="sandboxStarterDesc" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.scenarioType">Тип сценария</label>
                <select id="sandboxStarterScenario" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="" data-i18n="sandbox.scenarioNone">Без типа</option>
                    <option value="tire_search">tire_search</option>
                    <option value="order_creation">order_creation</option>
                    <option value="fitting_booking">fitting_booking</option>
                    <option value="expert_consultation">expert_consultation</option>
                    <option value="operator_transfer">operator_transfer</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sandbox.starterPersona">Персона</label>
                <select id="sandboxStarterPersona" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="neutral" data-i18n="sandbox.personaNeutral">Нейтральный</option>
                    <option value="angry" data-i18n="sandbox.personaAngry">Раздражённый</option>
                    <option value="confused" data-i18n="sandbox.personaConfused">Растерянный</option>
                    <option value="rushed" data-i18n="sandbox.personaRushed">Спешащий</option>
                    <option value="detailed" data-i18n="sandbox.personaDetailed">Дотошный</option>
                </select>
            </div>
            <button onclick="window._pages.sandbox.saveStarter()" class="w-full py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors cursor-pointer" data-i18n="common.save">Сохранить</button>
        </div>
    </div>

    <!-- Vehicle Import Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="vehicleImportModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-[700px] w-[90%] max-h-[80vh] overflow-y-auto max-md:w-[95%]">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('vehicleImportModal')">&times;</span>
            <h2 class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" data-i18n="vehicles.importTitle">Обновление базы автомобилей</h2>
            <div class="mb-3 p-3 bg-neutral-50 dark:bg-neutral-800 rounded-md text-sm text-neutral-600 dark:text-neutral-400">
                <p class="mb-2 font-medium text-neutral-700 dark:text-neutral-300" data-i18n="vehicles.importInstructions">Разместите 4 CSV-файла в директории на сервере:</p>
                <ul class="list-disc ml-5 mb-2 space-y-0.5 font-mono text-xs">
                    <li>test_table_car2_brand.csv</li>
                    <li>test_table_car2_model.csv</li>
                    <li>test_table_car2_kit.csv <span class="text-neutral-400">(latin-1)</span></li>
                    <li>test_table_car2_kit_tyre_size.csv</li>
                </ul>
                <p class="text-xs text-neutral-500 dark:text-neutral-500" data-i18n="vehicles.importWarning">Импорт удалит текущие данные и загрузит новые. Операция занимает ~30-60 секунд.</p>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="vehicles.importPathLabel">Путь к директории с CSV</label>
                <input type="text" id="vehicleImportPath" placeholder="/path/to/csv/files"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <button class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-violet-600 text-white hover:bg-violet-700"
                id="vehicleImportBtn" onclick="window._pages.vehicles.runImport()" data-i18n="vehicles.importBtn">Импортировать</button>
        </div>
    </div>

    <!-- Create User Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="createUserModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-[700px] w-[90%] max-h-[80vh] overflow-y-auto max-md:w-[95%]">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('createUserModal')">&times;</span>
            <h2 class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" data-i18n="users.createTitle">Создание нового пользователя</h2>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="users.usernameLabel">Имя пользователя</label>
                <input type="text" id="newUsername" data-i18n-placeholder="users.usernamePlaceholder" placeholder="имя пользователя"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="users.passwordLabel">Пароль</label>
                <input type="password" id="newPassword" data-i18n-placeholder="users.passwordPlaceholder" placeholder="пароль"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="users.roleLabel">Роль</label>
                <select id="newRole"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="operator" data-i18n="users.roleOperator">Оператор</option>
                    <option value="analyst" data-i18n="users.roleAnalyst">Аналитик</option>
                    <option value="content_manager" data-i18n="users.roleContentManager">Контент-менеджер</option>
                    <option value="admin" data-i18n="users.roleAdmin">Админ</option>
                </select>
            </div>
            <button class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700" onclick="window._pages.users.createUser()" data-i18n="common.create">Создать</button>
        </div>
    </div>

    <!-- Call Detail Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="callModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-[700px] w-[90%] max-h-[80vh] overflow-y-auto max-md:w-[95%]">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._pages.calls.closeCallModal()">&times;</span>
            <h2 class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" data-i18n="calls.detailTitle">Детали звонка</h2>
            <div id="callDetailContent"></div>
        </div>
    </div>

    <!-- Create Prompt Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="createPromptModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-[700px] w-[90%] max-h-[80vh] overflow-y-auto max-md:w-[95%]">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('createPromptModal')">&times;</span>
            <h2 id="createPromptModalTitle" class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" data-i18n="prompts.createTitle">Создание новой версии промпта</h2>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="prompts.nameLabel">Название</label>
                <input type="text" id="promptName" data-i18n-placeholder="prompts.namePlaceholder" placeholder="напр. v2.0-improved-search"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-3">
                <div class="flex items-center justify-between mb-1">
                    <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300" data-i18n="prompts.systemPromptLabel">Системный промпт</label>
                    <button id="loadDefaultBtn" class="inline-flex items-center px-2 py-1 text-xs font-medium rounded transition-colors cursor-pointer bg-neutral-500 text-white hover:bg-neutral-600 dark:bg-neutral-600 dark:hover:bg-neutral-500" onclick="window._pages.prompts.loadDefaultPrompt()" data-i18n="prompts.loadDefault">Загрузить системный</button>
                </div>
                <textarea id="promptSystemPrompt" data-i18n-placeholder="prompts.systemPromptPlaceholder" placeholder="Введите текст системного промпта..."
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-30 font-mono resize-y"></textarea>
            </div>
            <button id="createPromptBtn" class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700" onclick="window._pages.prompts.createPrompt()" data-i18n="common.create">Создать</button>
        </div>
    </div>

    <!-- Create A/B Test Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="createABTestModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-[500px] w-[90%] max-h-[80vh] overflow-y-auto max-md:w-[95%]">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('createABTestModal')">&times;</span>
            <h2 class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" data-i18n="prompts.createABTestTitle">Создание A/B-теста</h2>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="prompts.testNameLabel">Название теста</label>
                <input type="text" id="abTestName" placeholder="напр. test-v3-vs-v4"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="prompts.variantALabel">Вариант A</label>
                <select id="abVariantA"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="prompts.variantBLabel">Вариант B</label>
                <select id="abVariantB"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </select>
            </div>
            <div class="mb-4">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="prompts.trafficSplitLabel">Разделение трафика (% вариант A)</label>
                <div class="flex items-center gap-3">
                    <input type="range" id="abTrafficSplit" min="10" max="90" value="50" step="5"
                        oninput="document.getElementById('abTrafficSplitValue').textContent = this.value + '%'"
                        class="flex-1 accent-blue-600">
                    <span id="abTrafficSplitValue" class="text-sm font-medium text-neutral-700 dark:text-neutral-300 w-10 text-right">50%</span>
                </div>
            </div>
            <button class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700" onclick="window._pages.prompts.createABTest()" data-i18n="common.create">Создать</button>
        </div>
    </div>

    <!-- A/B Test Report Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="abReportModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-[900px] w-[90%] max-h-[80vh] overflow-y-auto max-md:w-[95%]">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('abReportModal')">&times;</span>
            <h2 class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" id="abReportModalTitle" data-i18n="prompts.abReportTitle">Отчёт A/B-теста</h2>
            <div id="abReportContent"></div>
        </div>
    </div>

    <!-- Create/Edit Article Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="createArticleModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-[700px] w-[90%] max-h-[80vh] overflow-y-auto max-md:w-[95%]">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('createArticleModal')">&times;</span>
            <h2 class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" id="articleModalTitle" data-i18n="knowledge.newArticleTitle">Новая статья</h2>
            <input type="hidden" id="editArticleId">
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="knowledge.titleLabel">Название</label>
                <input type="text" id="articleTitle" data-i18n-placeholder="knowledge.titlePlaceholder" placeholder="Название статьи"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="knowledge.categoryLabel">Категория</label>
                <select id="articleCategory"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="knowledge.contentLabel">Содержание (Markdown)</label>
                <textarea id="articleContent" data-i18n-placeholder="knowledge.contentPlaceholder" placeholder="Содержание статьи в формате Markdown..."
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-30 font-mono resize-y"></textarea>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="knowledge.expiresAtLabel">Срок действия (необязательно)</label>
                <input type="datetime-local" id="articleExpiresAt"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <p class="text-xs text-neutral-500 dark:text-neutral-400 mt-1" data-i18n="knowledge.expiresAtHint">Статья автоматически скроется после этой даты. Пусто = бессрочно.</p>
            </div>
            <button class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700" onclick="window._pages.knowledge.saveArticle()" data-i18n="common.save">Сохранить</button>
        </div>
    </div>

    <!-- Create/Edit Operator Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="operatorModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-[700px] w-[90%] max-h-[80vh] overflow-y-auto max-md:w-[95%]">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('operatorModal')">&times;</span>
            <h2 class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" id="operatorModalTitle" data-i18n="operators.newOperatorTitle">Новый оператор</h2>
            <input type="hidden" id="editOperatorId">
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="operators.nameLabel">Имя</label>
                <input type="text" id="operatorName" data-i18n-placeholder="operators.namePlaceholder" placeholder="ФИО"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="operators.extensionLabel">Внутр. номер (SIP)</label>
                <input type="text" id="operatorExtension" data-i18n-placeholder="operators.extensionPlaceholder" placeholder="напр. 101"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="operators.skillsLabel">Навыки (через запятую)</label>
                <input type="text" id="operatorSkills" data-i18n-placeholder="operators.skillsPlaceholder" placeholder="шины, заказы, шиномонтаж"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="operators.shiftStartLabel">Начало смены</label>
                <input type="time" id="operatorShiftStart" value="09:00"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="operators.shiftEndLabel">Конец смены</label>
                <input type="time" id="operatorShiftEnd" value="18:00"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <button class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700" onclick="window._pages.operators.saveOperator()" data-i18n="common.save">Сохранить</button>
        </div>
    </div>

    <!-- Import Documents Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="importDocumentsModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-[700px] w-[90%] max-h-[80vh] overflow-y-auto max-md:w-[95%]">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('importDocumentsModal')">&times;</span>
            <h2 class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" data-i18n="knowledge.importTitle">Импорт документов</h2>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="knowledge.importFilesLabel">Файлы (MD, PDF, DOCX)</label>
                <input type="file" id="importFiles" multiple accept=".md,.markdown,.pdf,.docx"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="knowledge.importCategoryLabel">Категория (необязательно, авто-определение если пусто)</label>
                <select id="importCategory"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="" data-i18n="knowledge.importAutoDetect">Авто-определение по имени файла</option>
                </select>
            </div>
            <button class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-violet-600 text-white hover:bg-violet-700" onclick="window._pages.knowledge.importDocuments()" data-i18n="knowledge.importBtn">Импортировать</button>
        </div>
    </div>

    <!-- Dialogue Example Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="dialogueModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-[700px] w-[90%] max-h-[80vh] overflow-y-auto max-md:w-[95%]">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('dialogueModal')">&times;</span>
            <h2 class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" id="dialogueModalTitle" data-i18n="training.newDialogue">Новый сценарий</h2>
            <input type="hidden" id="editDialogueId">
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="training.dialogueTitle">Название</label>
                <input type="text" id="dialogueTitle" data-i18n-placeholder="training.dialogueTitlePlaceholder" placeholder="Название сценария"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="training.scenario">Тип сценария</label>
                <select id="dialogueScenarioType"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="tire_search">tire_search</option>
                    <option value="availability_check">availability_check</option>
                    <option value="order_creation">order_creation</option>
                    <option value="order_status">order_status</option>
                    <option value="fitting_booking">fitting_booking</option>
                    <option value="expert_consultation">expert_consultation</option>
                    <option value="operator_transfer">operator_transfer</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="training.phase">Фаза</label>
                <select id="dialoguePhase"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="mvp">mvp</option>
                    <option value="orders">orders</option>
                    <option value="services">services</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="training.dialogueJSON">Диалог (JSON)</label>
                <textarea id="dialogueJSON" placeholder='[{"role": "customer", "text": "..."}, ...]'
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-30 font-mono resize-y"></textarea>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="training.description">Описание</label>
                <input type="text" id="dialogueDescription"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <button class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700" onclick="window._pages.scenarios.saveDialogue()" data-i18n="common.save">Сохранить</button>
        </div>
    </div>

    <!-- Safety Rule Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="safetyRuleModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-[700px] w-[90%] max-h-[80vh] overflow-y-auto max-md:w-[95%]">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('safetyRuleModal')">&times;</span>
            <h2 class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" id="safetyRuleModalTitle" data-i18n="training.newSafetyRule">Новое правило</h2>
            <input type="hidden" id="editSafetyRuleId">
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="training.ruleTitle">Название</label>
                <input type="text" id="safetyRuleTitle"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="training.ruleType">Тип правила</label>
                <select id="safetyRuleType"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="prompt_injection">prompt_injection</option>
                    <option value="data_validation">data_validation</option>
                    <option value="off_topic">off_topic</option>
                    <option value="language">language</option>
                    <option value="behavioral">behavioral</option>
                    <option value="escalation">escalation</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="training.severity">Серьёзность</label>
                <select id="safetyRuleSeverity"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="low">low</option>
                    <option value="medium" selected>medium</option>
                    <option value="high">high</option>
                    <option value="critical">critical</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="training.triggerInput">Триггер (ввод клиента)</label>
                <textarea id="safetyTriggerInput"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-20 resize-y"></textarea>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="training.expectedBehavior">Ожидаемое поведение</label>
                <textarea id="safetyExpectedBehavior"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-20 resize-y"></textarea>
            </div>
            <button class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700" onclick="window._pages.scenarios.saveSafetyRule()" data-i18n="common.save">Сохранить</button>
        </div>
    </div>

    <!-- Response Template Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="responseTemplateModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-[700px] w-[90%] max-h-[80vh] overflow-y-auto max-md:w-[95%]">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('responseTemplateModal')">&times;</span>
            <h2 class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" id="templateModalTitle" data-i18n="training.newTemplate">Новый шаблон</h2>
            <input type="hidden" id="editTemplateId">
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="training.templateKey">Ключ</label>
                <select id="templateKey"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="greeting">greeting</option>
                    <option value="farewell">farewell</option>
                    <option value="silence_prompt">silence_prompt</option>
                    <option value="transfer">transfer</option>
                    <option value="error">error</option>
                    <option value="wait">wait</option>
                    <option value="order_cancelled">order_cancelled</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="training.templateTitle">Название</label>
                <input type="text" id="templateTitle"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="training.content">Содержание</label>
                <textarea id="templateContent"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-20 resize-y"></textarea>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="training.description">Описание</label>
                <input type="text" id="templateDescription"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <button class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700" onclick="window._pages.scenarios.saveTemplate()" data-i18n="common.save">Сохранить</button>
        </div>
    </div>

    <!-- Tool Override Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="toolOverrideModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-[700px] w-[90%] max-h-[80vh] overflow-y-auto max-md:w-[95%]">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('toolOverrideModal')">&times;</span>
            <h2 class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" id="toolOverrideModalTitle" data-i18n="training.editTool">Редактирование инструмента</h2>
            <input type="hidden" id="editToolName">
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="training.originalDescription">Описание по умолчанию</label>
                <p class="text-sm text-neutral-500 dark:text-neutral-400 bg-neutral-50 dark:bg-neutral-800 p-3 rounded" id="toolOriginalDescription"></p>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="training.overrideDescription">Переопределённое описание</label>
                <textarea id="toolOverrideDescription"
                    class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-30 resize-y"></textarea>
            </div>
            <button class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700" onclick="window._pages.tools.saveToolOverride()" data-i18n="common.save">Сохранить</button>
        </div>
    </div>

    <!-- Source Config Modal -->
    <div class="modal-overlay fixed inset-0 bg-black/50 z-[100] justify-center items-center" id="sourceConfigModal">
        <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl p-6 max-w-[700px] w-[90%] max-h-[80vh] overflow-y-auto max-md:w-[95%]">
            <span class="float-right cursor-pointer text-lg text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-200 transition-colors leading-none" onclick="window._app.closeModal('sourceConfigModal')">&times;</span>
            <h2 id="sourceConfigModalTitle" class="text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4" data-i18n="sources.addSource">Добавить источник</h2>
            <input type="hidden" id="editSourceConfigId">
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sources.sourceName">Название</label>
                <input type="text" id="sourceConfigName" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="ADAC Reifentest">
            </div>
            <div class="grid grid-cols-2 gap-3 mb-3">
                <div>
                    <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sources.sourceType">Тип</label>
                    <select id="sourceConfigType" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="generic_html">HTML</option>
                        <option value="rss">RSS</option>
                        <option value="prokoleso">ProKoleso</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sources.sourceLanguage">Язык</label>
                    <select id="sourceConfigLanguage" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="uk">Українська</option>
                        <option value="de">Deutsch</option>
                        <option value="en">English</option>
                        <option value="fr">Français</option>
                    </select>
                </div>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sources.sourceUrl">URL</label>
                <input type="text" id="sourceConfigUrl" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://example.com">
            </div>
            <div class="grid grid-cols-3 gap-3 mb-3">
                <div>
                    <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sources.maxArticles">Макс. статей</label>
                    <input type="number" id="sourceConfigMaxArticles" value="20" min="1" max="100" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sources.scheduleDay">День</label>
                    <select id="sourceConfigDay" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="monday">Пн</option><option value="tuesday">Вт</option><option value="wednesday">Ср</option><option value="thursday">Чт</option><option value="friday">Пт</option><option value="saturday">Сб</option><option value="sunday">Вс</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sources.scheduleHour">Час</label>
                    <input type="number" id="sourceConfigHour" value="6" min="0" max="23" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
            </div>
            <div class="flex gap-4 mb-3">
                <label class="flex items-center gap-2 text-sm cursor-pointer">
                    <input type="checkbox" id="sourceConfigEnabled">
                    <span data-i18n="sources.enabled">Включён</span>
                </label>
                <label class="flex items-center gap-2 text-sm cursor-pointer">
                    <input type="checkbox" id="sourceConfigAutoApprove">
                    <span data-i18n="sources.autoApprove">Авто-публикация</span>
                </label>
            </div>
            <div class="mb-3">
                <label class="block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1" data-i18n="sources.settingsJson">Настройки (JSON)</label>
                <textarea id="sourceConfigSettings" rows="3" class="w-full px-3 py-2 text-sm border border-neutral-300 dark:border-neutral-700 rounded-md bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono resize-y">{}</textarea>
            </div>
            <button class="inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md transition-colors cursor-pointer bg-blue-600 text-white hover:bg-blue-700" onclick="window._pages.knowledge.saveSourceConfig()" data-i18n="common.save">Сохранить</button>
        </div>
    </div>

    <script type="module" src="/src/main.js"></script>
</body>
</html>
