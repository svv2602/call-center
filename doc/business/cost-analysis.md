# Анализ стоимости звонка — Call Center AI

**Дата:** 2026-02-15
**Версия:** 1.0
**Инструмент:** `scripts/cost_analysis.py`

## Резюме

Стоимость одного звонка: **$0.07–0.10** (значительно ниже таргета $0.15–0.30).
При 500 звонков/день AI-система обходится в **$1,195–1,675/мес** vs **$1,875/мес** у оператора.

## Параметры расчёта

| Параметр | Значение |
|----------|----------|
| Средняя длительность звонка | 90 секунд |
| Обороты диалога (LLM turns) | 4 |
| Input tokens / turn | 2,500 (system prompt + context + tools) |
| Output tokens / turn | 400 |
| TTS символов / звонок | 600 |
| TTS cache hit rate | 30% |
| Объём | 500 звонков/день (15,000/мес) |

## Breakdown по компонентам

### Per-call

| Компонент | Google STT | Whisper STT |
|-----------|-----------|-------------|
| STT | $0.0420 | $0.0100 |
| LLM (Claude Sonnet) | $0.0540 | $0.0540 |
| TTS (Google) | $0.0017 | $0.0017 |
| **Итого** | **$0.0977** | **$0.0657** |

### Monthly (500 звонков/день)

| Компонент | Google STT | Whisper STT |
|-----------|-----------|-------------|
| STT | $630 | $150 |
| LLM (Claude Sonnet) | $810 | $810 |
| TTS (Google) | $25 | $25 |
| Инфраструктура | $210 | $210 |
| **Итого** | **$1,675/мес** | **$1,195/мес** |

### Инфраструктура

| Компонент | Стоимость/мес |
|-----------|---------------|
| SIP-провайдер | $50 |
| App-сервер (4 vCPU, 8GB) | $80 |
| DB-сервер (PostgreSQL + Redis) | $60 |
| Мониторинг (Prometheus + Grafana) | $20 |
| **Итого** | **$210** |

## Сравнение Google STT vs Whisper

| Метрика | Google STT | Whisper (self-hosted) |
|---------|-----------|----------------------|
| Стоимость/мес (500 зв/день) | $630 | $150 |
| Стоимость/звонок | $0.042 | $0.010 |
| Экономия | — | **$480/мес (28.7%)** |
| Latency | ~100-300ms (streaming) | ~500-2000ms (batch) |
| Модель ценообразования | Pay-per-use | Fixed GPU |
| Streaming | Да | Нет (batch) |
| Точность (uk-UA) | Высокая | Высокая (large-v3) |
| Fallback | — | Google STT |
| Feature flag | `FF_STT_PROVIDER=google` | `FF_STT_PROVIDER=whisper` |

### Когда переходить на Whisper

| Объём | Google STT/мес | Whisper/мес | Рекомендация |
|-------|---------------|-------------|--------------|
| 100 зв/день | $126 | $150 | Google (Whisper дороже) |
| 200 зв/день | $252 | $150 | **Whisper (экономия $102)** |
| 500 зв/день | $630 | $150 | **Whisper (экономия $480)** |
| 1000 зв/день | $1,260 | $150* | **Whisper (экономия $1,110)** |

*При высоких объёмах может потребоваться более мощный GPU — $200-300/мес.

**Breakeven point:** ~120 звонков/день.

## Сравнение с оператором

| Метрика | AI (Google STT) | AI (Whisper) | Оператор |
|---------|----------------|-------------|----------|
| Стоимость/звонок | $0.098 | $0.066 | $0.125 |
| Стоимость/мес (500 зв/день) | $1,675 | $1,195 | $1,875 |
| ROI vs оператор | 12% | 57% | — |
| Доступность | 24/7 | 24/7 | 8-10 ч/день |
| Масштабирование | Линейное | Фиксированное | Найм + обучение |

## Рекомендации по оптимизации

### 1. STT — переход на Whisper ($480/мес экономии)
- Включить через `FF_STT_PROVIDER=whisper`
- Gradual rollout: `FF_WHISPER_ROLLOUT_PERCENT=10` → 50 → 100
- Мониторить accuracy через `stt_provider_accuracy` метрику
- Fallback на Google STT при ошибках

### 2. TTS — увеличить cache hit rate
- Текущий: 30% → Цель: 50-60%
- Расширить список pre-cached фраз (приветствия, подтверждения, прощания)
- Экономия: ~$8-10/мес (незначительная)

### 3. LLM — основная статья расходов (54% бюджета)
- Оптимизировать system prompt (сократить без потери качества)
- Для простых сценариев (статус заказа) → Claude Haiku ($0.25/$1.25 per 1M)
- Кеширование tool results между turns
- Потенциальная экономия: 20-40% на LLM → $160-320/мес

### 4. Приоритет оптимизаций

| # | Действие | Экономия/мес | Сложность |
|---|----------|-------------|-----------|
| 1 | Whisper STT rollout | $480 | Средняя |
| 2 | Claude Haiku для простых сценариев | $200-300 | Средняя |
| 3 | Оптимизация system prompt | $80-150 | Низкая |
| 4 | TTS cache expansion | $10 | Низкая |

## Запуск скрипта

```bash
# Стандартный расчёт
python3 scripts/cost_analysis.py

# Кастомные параметры
python3 scripts/cost_analysis.py --calls-per-day 1000 --avg-duration 120

# JSON вывод
python3 scripts/cost_analysis.py --json
```
